<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°çº¢ä¹¦æ–‡æ¡ˆç”Ÿæˆå™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        
        .admin-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.5);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .admin-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
        }
        
        .section-title::before {
            content: "";
            display: inline-block;
            width: 4px;
            height: 20px;
            background: #667eea;
            margin-right: 10px;
            border-radius: 2px;
        }
        
        .info-box {
            background: white;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        
        .info-box h3 {
            color: #667eea;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .info-box p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .info-box a {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }
        
        .info-box a:hover {
            text-decoration: underline;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
            font-size: 14px;
        }
        
        input[type="text"],
        input[type="password"],
        input[type="date"],
        input[type="file"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-download {
            background: #17a2b8;
            color: white;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .status {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .hidden {
            display: none !important;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.show {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }
        
        .code-display {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
        }
        
        .code-text {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }
        
        .code-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .code-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #e0e0e0;
        }
        
        .progress-container {
            margin-top: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .log {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.8;
        }
        
        .log-item {
            margin-bottom: 5px;
            padding: 5px;
            border-left: 3px solid #667eea;
            padding-left: 10px;
        }
        
        .quick-date {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .quick-date button {
            flex: 1;
            padding: 8px;
            background: #e9ecef;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .quick-date button:hover {
            background: #dee2e6;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        .template-info {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        
        .template-info strong {
            color: #0066cc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="admin-btn" onclick="window.location.href='index.html'" style="left: 20px; right: auto;">
                â† è¿”å›ä¸»é¡µ
            </button>
            <h1>ğŸ¨ å°çº¢ä¹¦æ–‡æ¡ˆç”Ÿæˆå™¨</h1>
            <p>ç½‘é¡µç‰ˆ v2.0 - ä¸“ä¸šã€é«˜æ•ˆã€æ˜“ç”¨</p>
            <button class="admin-btn" onclick="showAdminModal()">âš™ï¸ ç®¡ç†</button>
        </div>
        
        <div class="content">
            <!-- é‡è¦æç¤ºï¼šAPIæ³¨å†Œ -->
            <div class="section">
                <div class="section-title">ğŸ“¢ ä½¿ç”¨å‰å¿…è¯»</div>
                
                <div class="info-box">
                    <h3>ğŸ”‘ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œå¹¶è´­ä¹°API</h3>
                    <p>æœ¬å·¥å…·éœ€è¦é…åˆGPTs APIä½¿ç”¨ï¼Œè¯·å…ˆæ³¨å†Œå¹¶å……å€¼ï¼š</p>
                    <p>
                        <strong>å®˜æ–¹ç½‘ç«™ï¼š</strong>
                        <a href="https://gptsapi.net/api" target="_blank">https://gptsapi.net/api</a>
                    </p>
                    <p>
                        <strong>æ³¨å†Œæµç¨‹ï¼š</strong>
                        1. ç‚¹å‡»ä¸Šæ–¹é“¾æ¥æ³¨å†Œè´¦å· â†’ 
                        2. å……å€¼ï¼ˆå»ºè®®Â¥5èµ·ï¼Œå¯ç”Ÿæˆçº¦50æ¡ï¼‰ â†’ 
                        3. è·å–API Key
                    </p>
                    <p>
                        <strong>è´¹ç”¨è¯´æ˜ï¼š</strong>
                        çº¦ Â¥0.1/æ¡æ–‡æ¡ˆï¼Œ50æ¡çº¦Â¥5ï¼Œä¸éœ€è¦æ¢¯å­ï¼Œå›½å†…å¯ç”¨
                    </p>
                    <p style="margin-top: 10px;">
                        <button class="btn btn-primary" onclick="showUserGuide()" style="padding: 8px 20px; font-size: 13px;">
                            ğŸ“– æŸ¥çœ‹è¯¦ç»†ä½¿ç”¨è¯´æ˜
                        </button>
                    </p>
                </div>
                
                <div class="info-box">
                    <h3>ğŸ“¥ ç¬¬äºŒæ­¥ï¼šä¸¤æ­¥æµç¨‹ç”Ÿæˆæ–‡æ¡ˆ</h3>
                    
                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ffc107;">
                        <strong style="color: #856404; font-size: 16px;">ğŸ’¡ å®Œæ•´æµç¨‹è¯´æ˜</strong><br>
                        <div style="margin-top: 10px; line-height: 2; color: #856404;">
                            <strong>â†’ æ­¥éª¤1ï¼šæ™ºèƒ½åˆ†é…é€‰é¢˜</strong><br>
                            ã€€ã€€ä¸‹è½½ç©ºç™½æ¨¡æ¿ â†’ å¡«å†™æ ‡é¢˜ â†’ ä¸Šä¼ è·å–æ™ºèƒ½åˆ†é…ç»“æœ<br><br>
                            <strong>â†’ æ­¥éª¤2ï¼šæ‰¹é‡ç”Ÿæˆæ–‡æ¡ˆ</strong><br>
                            ã€€ã€€ä¸Šä¼ åˆ†é…ç»“æœ â†’ å¼€å§‹ç”Ÿæˆ â†’ ä¸‹è½½æœ€ç»ˆæ–‡æ¡ˆ
                        </div>
                    </div>
                </div>
                
                <!-- æ­¥éª¤1ï¼šæ™ºèƒ½åˆ†é…é€‰é¢˜ -->
                <div class="info-box" style="border-left: 4px solid #28a745;">
                    <h3>ğŸ¯ æ­¥éª¤1ï¼šæ™ºèƒ½åˆ†é…é€‰é¢˜</h3>
                    
                    <div style="background: #e7f3ff; padding: 12px; border-radius: 6px; margin-bottom: 15px;">
                        <strong style="color: #0066cc;">æ“ä½œæµç¨‹ï¼š</strong><br>
                        1ï¸âƒ£ ä¸‹è½½ç©ºç™½æ¨¡æ¿ â†’ 2ï¸âƒ£ å¡«å†™æ ‡é¢˜åˆ— â†’ 3ï¸âƒ£ ä¸Šä¼ æ™ºèƒ½åˆ†é… â†’ 4ï¸âƒ£ ä¸‹è½½åˆ†é…ç»“æœ
                    </div>
                    
                    <div class="btn-group">
                        <button class="btn btn-download" onclick="downloadBlankTemplate()">
                            ğŸ“¥ 1. ä¸‹è½½ç©ºç™½æ¨¡æ¿
                        </button>
                        <button class="btn btn-success" onclick="showTopicAssigner()">
                            ğŸ¯ 2. æ™ºèƒ½åˆ†é…é€‰é¢˜
                        </button>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; margin-top: 15px; font-size: 13px;">
                        <strong>ğŸ“‹ ç©ºç™½æ¨¡æ¿æ ¼å¼ï¼š</strong>åªæœ‰"æ ‡é¢˜"åˆ—<br>
                        <strong>ğŸ“‹ åˆ†é…ç»“æœæ ¼å¼ï¼š</strong>åºå·ã€æ¨¡æ¿ç±»å‹ã€æ ‡é¢˜ã€é€‰é¢˜ã€ç”Ÿæˆæ•°é‡
                    </div>
                </div>
                
                <!-- æ­¥éª¤2ï¼šæ‰¹é‡ç”Ÿæˆï¼ˆåœ¨ç”ŸæˆåŒºåŸŸä¼šè¯¦ç»†è¯´æ˜ï¼‰ -->
            </div>
            </div>
            
            <!-- é€‰é¢˜æ™ºèƒ½åˆ†é…å·¥å…· -->
            <div class="section hidden" id="topicAssignerSection">
                <div class="section-title">ğŸ¯ æ­¥éª¤1-2ï¼šæ™ºèƒ½åˆ†é…é€‰é¢˜</div>
                
                <div class="info-box" style="background: #e7f3ff; border-left: 4px solid #0066cc;">
                    <h3 style="color: #0066cc; margin-bottom: 10px;">ğŸ“¤ ä¸Šä¼ å¡«å†™å¥½çš„æ ‡é¢˜Excel</h3>
                    <p style="margin-bottom: 10px;">
                        <strong>ç³»ç»Ÿå°†è‡ªåŠ¨ä¸ºæ¯ä¸ªæ ‡é¢˜åˆ†é…ï¼š</strong>
                    </p>
                    <div style="background: white; padding: 10px; border-radius: 6px;">
                        âœ… <strong>æ¨¡æ¿ç±»å‹</strong>ï¼šæ¨¡æ¿1ï¼ˆæŠ€èƒ½ç±»ï¼‰/ æ¨¡æ¿2ï¼ˆåŸå› ç±»ï¼‰/ æ¨¡æ¿3ï¼ˆæ•™ç¨‹ç±»ï¼‰<br>
                        âœ… <strong>é€‰é¢˜/ä¸»é¢˜</strong>ï¼šæ¥è¯ã€äººæƒ…ä¸–æ•…ã€ç¤¾äº¤æ™ºæ…§ã€ç©ä¸ç†Ÿã€é˜²å¥—è¯ã€é€šç”¨<br>
                        âœ… <strong>ç”Ÿæˆæ•°é‡</strong>ï¼šé»˜è®¤æ¯ä¸ªæ ‡é¢˜ç”Ÿæˆ1æ¡ï¼ˆå¯ä¿®æ”¹ï¼‰
                    </div>
                </div>
                
                <div class="form-group">
                    <label>ä¸Šä¼ æ ‡é¢˜Excelï¼ˆä»…åŒ…å«"æ ‡é¢˜"åˆ—ï¼‰</label>
                    <input type="file" id="titleFile" accept=".xlsx,.xls" onchange="handleTitleFile()">
                    <div class="status hidden" id="titleFileInfo"></div>
                </div>
                
                <button class="btn btn-primary" id="assignBtn" onclick="assignTopics()" disabled>å¼€å§‹æ™ºèƒ½åˆ†é…</button>
                
                <div class="progress-container hidden" id="assignProgress">
                    <div class="status info" id="assignStatus"></div>
                </div>
            </div>

            <!-- ç”¨æˆ·ç«¯ï¼šæ¿€æ´»åŒº -->
            <div class="section" id="activationSection">
                <div class="section-title">ğŸ”‘ è½¯ä»¶æ¿€æ´»</div>
                <div class="form-group">
                    <label>æ¿€æ´»ç </label>
                    <input type="text" id="activationCode" placeholder="ä¾‹å¦‚: XHS-ALL-20261231-7BF5">
                </div>
                <button class="btn btn-primary" onclick="activate()">æ¿€æ´»è½¯ä»¶</button>
                <div class="status hidden" id="activationStatus"></div>
            </div>
            
            <!-- ç”¨æˆ·ç«¯ï¼šå·²æ¿€æ´»ä¿¡æ¯ -->
            <div class="section hidden" id="activatedInfo">
                <div class="section-title">âœ… å·²æ¿€æ´»</div>
                <p>ä¸šåŠ¡çº¿: <span id="businessInfo"></span></p>
                <p>åˆ°æœŸæ—¶é—´: <span id="expireInfo"></span></p>
                <button class="btn btn-secondary" onclick="resetActivation()">é‡æ–°æ¿€æ´»</button>
            </div>
            
            <!-- ç”¨æˆ·ç«¯ï¼šAPIé…ç½® -->
            <div class="section hidden" id="apiSection">
                <div class="section-title">âš™ï¸ APIé…ç½®</div>
                <div class="info-box">
                    <p>è¯·è¾“å…¥æ‚¨ä» <a href="https://gptsapi.net/api" target="_blank">GPTs API</a> è·å–çš„API Key</p>
                </div>
                <div class="form-group">
                    <label>GPTs API Key</label>
                    <input type="password" id="apiKey" placeholder="sk-xxxxxxxxxxxxxxxx">
                </div>
                <button class="btn btn-primary" onclick="saveApiKey()">ä¿å­˜é…ç½®</button>
                <div class="status hidden" id="apiStatus"></div>
            </div>
            
            <!-- ç”¨æˆ·ç«¯ï¼šç”ŸæˆåŒº -->
            <div class="section hidden" id="generateSection">
                <div class="section-title">ğŸ“ æ‰¹é‡ç”Ÿæˆ</div>
                
                <button id="restoreBtn" class="btn" style="display: none; background: #ff9800; margin-bottom: 15px; width: 100%;" onclick="restoreLastResults()">
                    ğŸ”„ æ¢å¤ä¸Šæ¬¡ç”Ÿæˆçš„ç»“æœ
                </button>
                
                <div class="info-box">
                    <p>
                        <strong>æ¸©é¦¨æç¤ºï¼š</strong>
                        è¯·ä½¿ç”¨ 
                        <button class="btn btn-download" onclick="downloadTemplate()" style="padding: 4px 12px; font-size: 12px; display: inline-block; margin: 0;">
                            ğŸ“¥ ä¸‹è½½æ ‡é¢˜æ¨¡æ¿
                        </button>
                        å¡«å†™åä¸Šä¼ ï¼Œé¿å…æ ¼å¼é”™è¯¯
                    </p>
                </div>
                
                <div class="form-group">
                    <label>ä¸Šä¼ æ ‡é¢˜Excelæ–‡ä»¶</label>
                    <input type="file" id="excelFile" accept=".xlsx,.xls" onchange="handleFileSelect()">
                    <div class="status hidden" id="fileInfo"></div>
                </div>
                
                <button class="btn btn-primary" id="generateBtn" onclick="startGeneration()" disabled>å¼€å§‹ç”Ÿæˆ</button>
                <button class="btn" style="background: #ff9800; color: white; display: none;" onclick="pauseGeneration()" id="pauseBtn">â¸ï¸ æš‚åœ</button>
                <button class="btn" style="background: #4CAF50; color: white; display: none;" onclick="resumeGeneration()" id="resumeBtn">â–¶ï¸ ç»§ç»­</button>
                
                <div class="progress-container hidden" id="progressContainer">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill">0%</div>
                    </div>
                    <div class="log" id="log"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç®¡ç†å‘˜æ¨¡æ€æ¡† -->
    <div class="modal" id="adminModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ğŸ”§ ç®¡ç†å‘˜é¢æ¿</div>
                <button class="close-btn" onclick="closeAdminModal()">Ã—</button>
            </div>
            
            <!-- ç®¡ç†å‘˜ç™»å½• -->
            <div id="adminLogin">
                <div class="form-group">
                    <label>ç®¡ç†å‘˜å¯†ç </label>
                    <input type="password" id="adminPassword" placeholder="è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
                </div>
                <button class="btn btn-primary" onclick="adminLogin()">ç™»å½•</button>
                <div class="status hidden" id="adminLoginStatus"></div>
            </div>
            
            <!-- ç®¡ç†å‘˜åŠŸèƒ½ -->
            <div id="adminPanel" class="hidden">
                <div class="section">
                    <div class="section-title">ğŸ« ç”Ÿæˆæ¿€æ´»ç </div>
                    
                    <div class="form-group">
                        <label>ä¸šåŠ¡çº¿</label>
                        <select id="businessType">
                            <option value="social">ç¤¾ä¼šåŒ–æŒ‡å—</option>
                            <option value="ring">æˆ’æŒ‡</option>
                            <option value="travel">æ—…æ¸¸</option>
                            <option value="psychology">å¿ƒç†æµ‹è¯•</option>
                            <option value="all">å…¨éƒ¨ä¸šåŠ¡çº¿</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>åˆ°æœŸæ—¥æœŸ</label>
                        <input type="date" id="expireDate">
                        <div class="quick-date">
                            <button onclick="setQuickDate(30)">1ä¸ªæœˆ</button>
                            <button onclick="setQuickDate(90)">3ä¸ªæœˆ</button>
                            <button onclick="setQuickDate(180)">6ä¸ªæœˆ</button>
                            <button onclick="setQuickDate(365)">1å¹´</button>
                            <button onclick="setQuickDate(3650)">æ°¸ä¹…</button>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="generateCode()">ç”Ÿæˆæ¿€æ´»ç </button>
                    
                    <div class="code-display hidden" id="codeDisplay">
                        <div class="code-text" id="generatedCode"></div>
                        <button class="btn btn-primary" onclick="copyCode()">å¤åˆ¶æ¿€æ´»ç </button>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">ğŸ“‹ å·²ç”Ÿæˆæ¿€æ´»ç åˆ—è¡¨</div>
                    <div class="code-list" id="codeList"></div>
                </div>
                
                <button class="btn btn-secondary" onclick="adminLogout()">é€€å‡ºç®¡ç†</button>
            </div>
        </div>
    </div>

    <!-- ä½¿ç”¨è¯´æ˜æ¨¡æ€æ¡† -->
    <div class="modal" id="guideModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">ğŸ“– è¯¦ç»†ä½¿ç”¨è¯´æ˜</div>
                <button class="close-btn" onclick="closeGuideModal()">Ã—</button>
            </div>
            
            <div style="max-height: 70vh; overflow-y: auto; padding: 10px;">
                
                <div class="info-box">
                    <h3 style="color: #667eea; font-size: 18px; margin-bottom: 15px;">
                        ğŸ¯ å®Œæ•´ä½¿ç”¨æµç¨‹ï¼ˆå°ç™½ç‰ˆï¼‰
                    </h3>
                    <p style="font-size: 14px; color: #666; line-height: 1.8;">
                        æœ¬å·¥å…·å¯ä»¥æ‰¹é‡ç”Ÿæˆå°çº¢ä¹¦æ–‡æ¡ˆï¼Œåªéœ€3æ­¥å³å¯å®Œæˆã€‚ä»¥ä¸‹æ˜¯ä»é›¶å¼€å§‹çš„å®Œæ•´æ•™ç¨‹ã€‚
                    </p>
                </div>

                <!-- ç¬¬ä¸€æ­¥ -->
                <div class="section" style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">
                        ğŸ“ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œå¹¶è´­ä¹°APIï¼ˆå¿…é¡»å®Œæˆï¼‰
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            1.1 æ‰“å¼€æ³¨å†Œç½‘ç«™
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»è¿™ä¸ªé“¾æ¥ï¼š<a href="https://gptsapi.net/api" target="_blank" style="color: #667eea; font-weight: bold;">https://gptsapi.net/api</a>
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æˆ–è€…å¤åˆ¶ç½‘å€åˆ°æµè§ˆå™¨æ‰“å¼€
                        </p>
                        <p style="color: #999; font-size: 12px; font-style: italic;">
                            ğŸ’¡ æç¤ºï¼šè¿™æ˜¯å®˜æ–¹APIæœåŠ¡å•†ï¼Œå®‰å…¨å¯é 
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            1.2 æ³¨å†Œè´¦å·
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»ç½‘ç«™ä¸Šçš„"æ³¨å†Œ"æŒ‰é’®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ è¾“å…¥é‚®ç®±å’Œå¯†ç ï¼ˆè®°ä½å¯†ç ï¼ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"æ³¨å†Œ"å®Œæˆ
                        </p>
                        <p style="color: #999; font-size: 12px; font-style: italic;">
                            â±ï¸ è€—æ—¶ï¼š1åˆ†é’Ÿ
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            1.3 å……å€¼ï¼ˆé‡è¦ï¼ï¼‰
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç™»å½•åï¼Œæ‰¾åˆ°"å……å€¼"æˆ–"ä½™é¢"æŒ‰é’®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ <strong style="color: #e74c3c;">å»ºè®®å……å€¼ï¼šÂ¥5å…ƒ</strong>ï¼ˆå¯ç”Ÿæˆçº¦50æ¡æ–‡æ¡ˆï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ”¯ä»˜æ–¹å¼ï¼šå¾®ä¿¡/æ”¯ä»˜å®/é“¶è¡Œå¡
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å……å€¼åä½™é¢ç«‹å³åˆ°è´¦
                        </p>
                        <div style="background: #fff3cd; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #856404; font-size: 12px; margin: 0;">
                                ğŸ’° <strong>è´¹ç”¨è¯´æ˜ï¼š</strong><br>
                                â€¢ 1æ¡æ–‡æ¡ˆ â‰ˆ Â¥0.1<br>
                                â€¢ 50æ¡æ–‡æ¡ˆ â‰ˆ Â¥5<br>
                                â€¢ 100æ¡æ–‡æ¡ˆ â‰ˆ Â¥10<br>
                                <strong>ç”¨å¤šå°‘æ‰£å¤šå°‘ï¼Œä½™é¢å¯æŸ¥çœ‹</strong>
                            </p>
                        </div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            1.4 è·å–API Keyï¼ˆå…³é”®ï¼ï¼‰
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å……å€¼åï¼Œæ‰¾åˆ°"APIç®¡ç†"æˆ–"API Key"èœå•
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"åˆ›å»ºæ–°çš„API Key"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ <strong style="color: #e74c3c;">å¤åˆ¶è¿™ä¸ªKeyå¹¶ä¿å­˜å¥½ï¼</strong>
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ Keyæ ¼å¼ç±»ä¼¼ï¼šsk-xxxxxxxxxxxxxxxx
                        </p>
                        <div style="background: #f8d7da; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #721c24; font-size: 12px; margin: 0;">
                                âš ï¸ <strong>é‡è¦æé†’ï¼š</strong><br>
                                â€¢ API Keyåªæ˜¾ç¤ºä¸€æ¬¡ï¼Œä¸€å®šè¦å¤åˆ¶ä¿å­˜ï¼<br>
                                â€¢ ä¸¢å¤±äº†éœ€è¦é‡æ–°åˆ›å»º
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬äºŒæ­¥ -->
                <div class="section" style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">
                        ğŸ“‹ ç¬¬äºŒæ­¥ï¼šå‡†å¤‡æ ‡é¢˜Excelæ–‡ä»¶
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            2.1 ä¸‹è½½æ¨¡æ¿ï¼ˆå¼ºçƒˆå»ºè®®ï¼ï¼‰
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åœ¨å·¥å…·ä¸»é¡µæ‰¾åˆ°"ğŸ“¥ ä¸‹è½½æ ‡é¢˜æ¨¡æ¿"æŒ‰é’®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»åè‡ªåŠ¨ä¸‹è½½Excelæ–‡ä»¶
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ–‡ä»¶åï¼š<span style="color: #667eea;">å°çº¢ä¹¦æ ‡é¢˜æ¨¡æ¿.xlsx</span>
                        </p>
                        <p style="color: #999; font-size: 12px; font-style: italic;">
                            ğŸ’¡ ä¸ºä»€ä¹ˆè¦ç”¨æ¨¡æ¿ï¼Ÿé¿å…æ ¼å¼é”™è¯¯ï¼Œçœæ—¶çœåŠ›ï¼
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            2.2 å¡«å†™æ ‡é¢˜ï¼ˆæŒ‰æ¨¡æ¿æ ¼å¼ï¼‰
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ‰“å¼€ä¸‹è½½çš„æ¨¡æ¿æ–‡ä»¶ï¼ˆç”¨Excelæˆ–WPSï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°ä¸¤åˆ—ï¼š<strong>"æ ‡é¢˜"</strong> å’Œ <strong>"é€‰é¢˜"</strong>
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åˆ é™¤æ¨¡æ¿é‡Œçš„ç¤ºä¾‹æ•°æ®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åœ¨"<strong>æ ‡é¢˜</strong>"åˆ—å¡«å†™ä½ çš„æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åœ¨"<strong>é€‰é¢˜</strong>"åˆ—å¡«å†™ç±»å‹ï¼ˆå¯é€‰ï¼Œå¦‚ï¼šæ¥è¯ã€äººæƒ…ä¸–æ•…ï¼‰
                        </p>
                        <div style="background: #d1ecf1; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #0c5460; font-size: 12px; margin: 0;">
                                ğŸ“ <strong>å¡«å†™ç¤ºä¾‹ï¼š</strong>
                            </p>
                            <table style="width: 100%; margin-top: 8px; border-collapse: collapse;">
                                <tr style="background: #bee5eb;">
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-weight: bold; font-size: 12px;">æ ‡é¢˜</td>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-weight: bold; font-size: 12px;">é€‰é¢˜</td>
                                </tr>
                                <tr>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-size: 12px;">ä¼šåŠäº‹çš„å¥³å­©å­æœ‰å¤šå‰å®³</td>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-size: 12px;">æ¥è¯</td>
                                </tr>
                                <tr>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-size: 12px;">ä½ çš„ç­”è°¢æ–¹å¼æš´éœ²äº†ç¤¾äº¤æ®µä½</td>
                                    <td style="padding: 6px; border: 1px solid #0c5460; font-size: 12px;">äººæƒ…ä¸–æ•…</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            2.3 ä¿å­˜æ–‡ä»¶
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å¡«å†™å®Œæˆåï¼Œç‚¹å‡»"ä¿å­˜"ï¼ˆCtrl+Sï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ è®°ä½æ–‡ä»¶ä¿å­˜ä½ç½®ï¼ˆå¦‚ï¼šæ¡Œé¢ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å…³é—­Excelæ–‡ä»¶
                        </p>
                    </div>
                </div>

                <!-- ç¬¬ä¸‰æ­¥ -->
                <div class="section" style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">
                        ğŸš€ ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨ç”Ÿæˆå™¨ç”Ÿæˆæ–‡æ¡ˆ
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            3.1 æ¿€æ´»è½¯ä»¶
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ‰¾åˆ°"ğŸ”‘ è½¯ä»¶æ¿€æ´»"åŒºåŸŸ
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ è¾“å…¥ç®¡ç†å‘˜ç»™ä½ çš„æ¿€æ´»ç 
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ¿€æ´»ç æ ¼å¼ï¼šXHS-XXX-XXXXXXXX-XXXX
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"æ¿€æ´»è½¯ä»¶"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°"âœ… æ¿€æ´»æˆåŠŸ"æç¤º
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            3.2 é…ç½®API Key
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ¿€æ´»åä¼šçœ‹åˆ°"âš™ï¸ APIé…ç½®"åŒºåŸŸ
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åœ¨è¾“å…¥æ¡†ä¸­ç²˜è´´ä½ çš„API Keyï¼ˆç¬¬ä¸€æ­¥è·å–çš„ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"ä¿å­˜é…ç½®"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°"âœ… API Keyå·²ä¿å­˜"
                        </p>
                        <div style="background: #f8d7da; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #721c24; font-size: 12px; margin: 0;">
                                âš ï¸ <strong>æ‰¾ä¸åˆ°API Keyï¼Ÿ</strong><br>
                                å›åˆ°ç¬¬ä¸€æ­¥1.4ï¼Œé‡æ–°æŸ¥çœ‹è·å–æ–¹æ³•
                            </p>
                        </div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            3.3 ä¸Šä¼ Excelæ–‡ä»¶
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ é…ç½®å®Œæˆåä¼šçœ‹åˆ°"ğŸ“ æ‰¹é‡ç”Ÿæˆ"åŒºåŸŸ
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»"é€‰æ‹©Excelæ–‡ä»¶"æˆ–"é€‰æ‹©æ–‡ä»¶"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ‰¾åˆ°ä½ åˆšæ‰ä¿å­˜çš„Excelæ–‡ä»¶
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åŒå‡»æ–‡ä»¶æˆ–ç‚¹å‡»"æ‰“å¼€"
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°"âœ… æ–‡ä»¶: xxx.xlsx | æ•°æ®: X æ¡"
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            3.4 å¼€å§‹ç”Ÿæˆ
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç‚¹å‡»è“è‰²çš„"å¼€å§‹ç”Ÿæˆ"æŒ‰é’®
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ä¼šå‡ºç°è¿›åº¦æ¡å’Œæ—¥å¿—
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ çœ‹åˆ°è¿›åº¦ï¼š1/10ã€2/10... é€æ­¥ç”Ÿæˆ
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ <strong>è€å¿ƒç­‰å¾…</strong>ï¼ˆæ¯æ¡çº¦3-5ç§’ï¼‰
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å…¨éƒ¨å®Œæˆåè‡ªåŠ¨ä¸‹è½½ç»“æœæ–‡ä»¶
                        </p>
                        <div style="background: #d4edda; padding: 10px; border-radius: 6px; margin-top: 10px;">
                            <p style="color: #155724; font-size: 12px; margin: 0;">
                                â±ï¸ <strong>ç”Ÿæˆæ—¶é—´ä¼°ç®—ï¼š</strong><br>
                                â€¢ 10æ¡æ ‡é¢˜ â‰ˆ 30-50ç§’<br>
                                â€¢ 50æ¡æ ‡é¢˜ â‰ˆ 3-5åˆ†é’Ÿ<br>
                                â€¢ 100æ¡æ ‡é¢˜ â‰ˆ 5-10åˆ†é’Ÿ
                            </p>
                        </div>
                    </div>
                </div>

                <!-- ç¬¬å››æ­¥ -->
                <div class="section" style="margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">
                        ğŸ“¥ ç¬¬å››æ­¥ï¼šæŸ¥çœ‹å’Œä½¿ç”¨ç”Ÿæˆç»“æœ
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            4.1 æ‰“å¼€ç»“æœæ–‡ä»¶
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç”Ÿæˆå®Œæˆåä¼šè‡ªåŠ¨ä¸‹è½½Excelæ–‡ä»¶
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ–‡ä»¶åï¼šå°çº¢ä¹¦æ–‡æ¡ˆ_æ—¥æœŸæ—¶é—´.xlsx
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ é€šå¸¸åœ¨"ä¸‹è½½"æ–‡ä»¶å¤¹ä¸­
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ åŒå‡»æ‰“å¼€æ–‡ä»¶
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            4.2 ç»“æœæ–‡ä»¶åŒ…å«ä»€ä¹ˆ
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            Excelæ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š
                        </p>
                        <table style="width: 100%; margin-top: 8px; border-collapse: collapse; font-size: 12px;">
                            <tr style="background: #f8f9fa;">
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">åºå·</td>
                                <td style="padding: 6px; border: 1px solid #ddd;">1, 2, 3...</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">æ ‡é¢˜</td>
                                <td style="padding: 6px; border: 1px solid #ddd;">ä½ æäº¤çš„æ ‡é¢˜</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">é€‰é¢˜</td>
                                <td style="padding: 6px; border: 1px solid #ddd;">æ¥è¯/äººæƒ…ä¸–æ•…ç­‰</td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">æ–‡æ¡ˆ</td>
                                <td style="padding: 6px; border: 1px solid #ddd;"><strong>ç”Ÿæˆçš„å®Œæ•´æ–‡æ¡ˆï¼ˆ600å­—å·¦å³ï¼‰</strong></td>
                            </tr>
                            <tr>
                                <td style="padding: 6px; border: 1px solid #ddd; font-weight: bold;">å­—æ•°</td>
                                <td style="padding: 6px; border: 1px solid #ddd;">æ–‡æ¡ˆå­—æ•°ç»Ÿè®¡</td>
                            </tr>
                        </table>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            4.3 å¦‚ä½•ä½¿ç”¨æ–‡æ¡ˆ
                        </h4>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ æ‰“å¼€Excelï¼Œæ‰¾åˆ°"æ–‡æ¡ˆ"åˆ—
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å¤åˆ¶éœ€è¦çš„æ–‡æ¡ˆå†…å®¹
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ ç²˜è´´åˆ°å°çº¢ä¹¦å‘å¸ƒç•Œé¢
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å¯ä»¥æ ¹æ®éœ€è¦ç¨ä½œä¿®æ”¹
                        </p>
                        <p style="color: #666; margin-bottom: 8px; font-size: 13px;">
                            â€¢ å‘å¸ƒå³å¯ï¼
                        </p>
                    </div>
                </div>

                <!-- å¸¸è§é—®é¢˜ -->
                <div class="section">
                    <h3 style="color: #e74c3c; margin-bottom: 15px; font-size: 16px;">
                        â“ å¸¸è§é—®é¢˜è§£ç­”
                    </h3>
                    
                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q1: éœ€è¦æ¢¯å­ï¼ˆVPNï¼‰å—ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            <strong style="color: #28a745;">âœ… ä¸éœ€è¦ï¼</strong>å›½å†…ç½‘ç»œå¯ç›´æ¥ä½¿ç”¨ï¼ŒGPTs APIæœåŠ¡å™¨åœ¨å›½å†…å¯è®¿é—®ã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q2: æ¿€æ´»ç åœ¨å“ªé‡Œè·å–ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            <strong>è”ç³»ç®¡ç†å‘˜è´­ä¹°ã€‚</strong>æ¿€æ´»ç åŒ…å«è½¯ä»¶ä½¿ç”¨æƒé™ï¼Œä¸åŒå¥—é¤æœ‰ä¸åŒæœ‰æ•ˆæœŸã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q3: APIè´¹ç”¨æ˜¯å¦å¤–ä»˜å—ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            <strong style="color: #e74c3c;">æ˜¯çš„ã€‚</strong>æ¿€æ´»ç æ˜¯è½¯ä»¶è´¹ç”¨ï¼ŒAPIè´¹ç”¨éœ€è¦è‡ªå·±åœ¨GPTs APIå……å€¼ï¼ŒæŒ‰å®é™…ä½¿ç”¨é‡æ‰£è´¹ã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q4: ç”Ÿæˆå¤±è´¥æ€ä¹ˆåŠï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px;">
                            å¯èƒ½åŸå› ï¼š<br>
                            1. API Keyé”™è¯¯ â†’ æ£€æŸ¥æ˜¯å¦å¤åˆ¶å®Œæ•´<br>
                            2. ä½™é¢ä¸è¶³ â†’ å»GPTs APIå……å€¼<br>
                            3. ç½‘ç»œé—®é¢˜ â†’ æ£€æŸ¥ç½‘ç»œè¿æ¥<br>
                            4. Excelæ ¼å¼é”™è¯¯ â†’ ä½¿ç”¨æä¾›çš„æ¨¡æ¿
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q5: å¯ä»¥ç”Ÿæˆå¤šå°‘æ¡ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            <strong>æ²¡æœ‰é™åˆ¶ï¼</strong>å–å†³äºä½ çš„æ¿€æ´»ç æœ‰æ•ˆæœŸå’ŒAPIä½™é¢ã€‚ä½™é¢ç”¨å®Œäº†å……å€¼å³å¯ç»§ç»­ä½¿ç”¨ã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q6: ç”Ÿæˆçš„æ–‡æ¡ˆè´¨é‡æ€ä¹ˆæ ·ï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            æ–‡æ¡ˆç”±Claude AIç”Ÿæˆï¼Œè´¨é‡å¾ˆé«˜ï¼Œçº¦600å­—ï¼ŒåŒ…å«emojiå’Œè¯é¢˜æ ‡ç­¾ï¼Œç›´æ¥å¯ç”¨ã€‚å»ºè®®ç¨ä½œä¿®æ”¹æ›´ç¬¦åˆä¸ªäººé£æ ¼ã€‚
                        </p>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px;">
                        <h4 style="color: #333; font-size: 14px; margin-bottom: 10px;">
                            Q7: ä½™é¢æŸ¥è¯¢åœ¨å“ªé‡Œï¼Ÿ
                        </h4>
                        <p style="color: #666; font-size: 13px; margin: 0;">
                            ç™»å½• <a href="https://gptsapi.net/api" target="_blank" style="color: #667eea;">GPTs APIå®˜ç½‘</a>ï¼Œåœ¨ç”¨æˆ·ä¸­å¿ƒå¯ä»¥çœ‹åˆ°ä½™é¢å’Œæ¶ˆè´¹è®°å½•ã€‚
                        </p>
                    </div>
                </div>

                <!-- å¿«é€Ÿæ£€æŸ¥æ¸…å• -->
                <div class="info-box" style="background: #d4edda; border-color: #c3e6cb;">
                    <h3 style="color: #155724; font-size: 16px; margin-bottom: 15px;">
                        âœ… ä½¿ç”¨å‰å¿«é€Ÿæ£€æŸ¥æ¸…å•
                    </h3>
                    <div style="font-size: 13px; color: #155724; line-height: 2;">
                        â˜‘ï¸ å·²åœ¨ GPTs API æ³¨å†Œå¹¶å……å€¼ï¼ˆè‡³å°‘Â¥5ï¼‰<br>
                        â˜‘ï¸ å·²è·å–å¹¶ä¿å­˜ API Key<br>
                        â˜‘ï¸ å·²ä¸‹è½½æ ‡é¢˜æ¨¡æ¿å¹¶å¡«å†™å¥½æ ‡é¢˜<br>
                        â˜‘ï¸ å·²è·å¾—æ¿€æ´»ç <br>
                        â˜‘ï¸ ç½‘ç»œè¿æ¥æ­£å¸¸<br>
                        <br>
                        <strong>å…¨éƒ¨æ‰“å‹¾ï¼Ÿå¼€å§‹ç”Ÿæˆå§ï¼ğŸš€</strong>
                    </div>
                </div>

            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn btn-primary" onclick="closeGuideModal()">æˆ‘çŸ¥é“äº†</button>
            </div>
        </div>
    </div>

    <script>
        // ========== é…ç½® ==========
        // ========== ç´ æåº“ç³»ç»Ÿ ==========
const MATERIALS = {
    // ========== æ¨¡æ¿1ï¼šåœºæ™¯ç½—åˆ—å¼ ==========
    'template1': {
        // åœºæ™¯å¡æ± ï¼ˆæŒ‰é€‰é¢˜åˆ†ç±»ï¼‰
        'scenes': {
            'æ¥è¯': [
                'æœ‹å‹è¯´"å‘¨æœ«å»çˆ¬å±±äº†"ï¼Œåªä¼šè¯´"å“¦"ï¼Œç„¶åå°±ä¸çŸ¥é“è¯´ä»€ä¹ˆäº†',
                'æœ‰äººåˆ†äº«"æœ€è¿‘åœ¨å­¦ç”»ç”»"ï¼Œé™¤äº†"å‰å®³"ä¸çŸ¥é“æ¥ä»€ä¹ˆ',
                'æœ‹å‹å…´å¥‹åœ°è¯´"æˆ‘å®¶çŒ«æ‹†äº†æ²™å‘"ï¼Œåªä¼šå›"å“ˆå“ˆ"ç„¶åå¯¹è¯å°±å¡ä½äº†',
                'æœ‰äººæåˆ°"å‘¨æœ«å»äº†å±•è§ˆ"ï¼Œé™¤äº†"ä¸é”™å•Š"æƒ³ä¸åˆ°åˆ«çš„',
                'æœ‹å‹è¯´"æœ€è¿‘åœ¨å­¦å‰ä»–"ï¼Œè¯´å®Œ"æŒºå¥½çš„"å°±å†·åœºäº†',
                'æœ‰äººåˆ†äº«"åˆšä¹°äº†æ–°æ‰‹æœº"ï¼Œåªä¼šè¯´"æŒºè´µå§"ç„¶åå°±æ²¡äº†',
                'æœ‹å‹æèµ·"ä¸Šå‘¨çœ‹äº†è¯å‰§"ï¼Œå›"æ€ä¹ˆæ ·"ä¹‹åæ¥ä¸ä¸Š',
                'æœ‰äººè¯´"å‘¨æœ«å»é’“é±¼äº†"ï¼Œé™¤äº†"é’“åˆ°äº†å—"æƒ³ä¸å‡ºåˆ«çš„'
            ],
            'å†·åœº': [
                'èŠç€èŠç€çªç„¶æ²¡è¯è¯´ï¼Œåªèƒ½å°´å°¬æ²‰é»˜',
                'å¥½ä¸å®¹æ˜“èŠèµ·æ¥ï¼Œä¸¤å¥è¯ååˆå¡ä½äº†',
                'æ˜æ˜æ°”æ°›æŒºå¥½ï¼Œå´æ€»åœ¨å…³é”®æ—¶åˆ»æ¥ä¸ä¸‹å»',
                'è¯é¢˜åˆšæ‰“å¼€ï¼Œè¯´å®Œä¸€å¥å°±å†·åœºäº†',
                'æœ‹å‹èšä¼šæ—¶ï¼Œè¯´çš„è¯æ€»è®©æ°”æ°›é™æ¸©',
                'æƒ³æ´»è·ƒæ°”æ°›ï¼Œä½†è¯´å‡ºæ¥çš„è¯åè€Œè®©åœºé¢æ›´å°´å°¬'
            ],
            'ç©ä¸ç†Ÿ': [
                'å’Œæ–°åŒå­¦èŠå¤©ï¼Œè¯´äº†å‡ å¥å°±ä¸çŸ¥é“èŠä»€ä¹ˆäº†',
                'æœ‹å‹ä»‹ç»çš„äººï¼Œæ‰“å®Œæ‹›å‘¼å°±é™·å…¥æ²‰é»˜',
                'èšä¼šä¸Šè§åˆ°çš„æ–°æœ‹å‹ï¼ŒèŠäº†ä¸¤å¥å°±å°´å°¬äº†',
                'æƒ³å’Œå¯¹æ–¹ç†Ÿèµ·æ¥ï¼Œå´ä¸çŸ¥é“æ€ä¹ˆå¼€è¯é¢˜',
                'æ˜æ˜æƒ³æ·±å…¥äº†è§£ï¼Œå´æ€»åœç•™åœ¨è¡¨é¢å®¢å¥—'
            ],
            'é¥­å±€': [
                'é¥­å±€ä¸Šä¸çŸ¥é“è¯¥è¯´ä»€ä¹ˆï¼Œåªèƒ½ä½å¤´åƒé¥­',
                'é•¿è¾ˆé—®èµ·å·¥ä½œå­¦ä¹ ï¼Œå›ç­”å®Œå°±å†·åœºäº†',
                'æ•¬é…’æ—¶é™¤äº†"è°¢è°¢"ä¸çŸ¥é“è¯´ä»€ä¹ˆ',
                'åˆ«äººèŠå¤©å¾ˆçƒ­é—¹ï¼Œè‡ªå·±æ’ä¸ä¸Šè¯',
                'ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™è¯¥è¯´è¯ï¼Œä»€ä¹ˆæ—¶å€™è¯¥å®‰é™'
            ],
            'äººæƒ…ä¸–æ•…': [
                'æœ‹å‹ç”Ÿæ—¥å¿˜äº†é€ç¤¼ï¼Œäº‹åæƒ³è¡¥å´ä¸çŸ¥é“æ€ä¹ˆè¯´',
                'é•¿è¾ˆç»™çº¢åŒ…ï¼Œä¸çŸ¥é“è¯¥æ¨è¾å‡ æ¬¡æ‰åˆé€‚',
                'æ”¶åˆ°ç¤¼ç‰©ä¸çŸ¥é“æ€ä¹ˆå›ç¤¼æ‰å¾—ä½“',
                'æƒ³å¸®å¿™å´ä¸çŸ¥é“æ€ä¹ˆè¯´ä¸æ˜¾å¾—å®¢å¥—',
                'è¢«äººå¸®äº†å¿™ï¼Œé™¤äº†è°¢è°¢ä¸çŸ¥é“æ€ä¹ˆè¡¨è¾¾'
            ],
            'é€šç”¨': [
                'å’ŒäººèŠå¤©æ€»æ˜¯ä¸‰å¥è¯å°±ç»“æŸï¼Œæ°”æ°›å°´å°¬',
                'èšä¼šæ—¶ä¸çŸ¥é“è¯´ä»€ä¹ˆï¼Œåªèƒ½ç©æ‰‹æœº',
                'æƒ³å’Œäººæå¥½å…³ç³»ï¼Œå´ä¸çŸ¥é“æ€ä¹ˆå¼€å§‹',
                'æ˜æ˜æƒ³è¡¨è¾¾å…³å¿ƒï¼Œå´æ€»æ˜¯è¯ä¸è¾¾æ„',
                'ç¤¾äº¤åœºåˆæ€»æ˜¯ç´§å¼ ï¼Œä¸çŸ¥é“è¯¥åšä»€ä¹ˆ'
            ]
        },
        
        // è§‚ç‚¹è¡¨è¾¾å¡æ± 
        'viewpoints': [
            'ç›´åˆ°åæ¥å‘ç°ï¼ŒçœŸæ­£å½±å“ç¤¾äº¤çš„ï¼Œä¸æ˜¯å¤©ç”Ÿæ€§æ ¼ï¼Œè€Œæ˜¯å¤§å®¶æœ€å®¹æ˜“å¿½è§†çš„æ¥è¯èƒ½åŠ›',
            'ç›´åˆ°æ…¢æ…¢å‘ç°ï¼ŒçœŸæ­£å†³å®šèŠå¤©èƒ½å¦ç»§ç»­çš„ï¼Œå¾€å¾€ä¸æ˜¯å£æ‰ï¼Œè€Œæ˜¯å¤§å®¶æœ€å®¹æ˜“å¿½è§†çš„é—²èŠèƒ½åŠ›',
            'ç›´åˆ°æ…¢æ…¢æ‰å‘ç°ï¼Œå…³ç³»å¥½ä¸å¥½ï¼Œè·Ÿæ€§æ ¼å…³ç³»ä¸å¤§ï¼Œå…³é”®æ˜¯æ¥è¯èƒ½åŠ›',
            'ç›´åˆ°è¿™äº›å¹´æ‰æ˜ç™½ï¼Œç¤¾äº¤çš„å…³é”®ï¼Œä»æ¥ä¸æ˜¯åˆ»æ„è®¨å¥½ï¼Œè€Œæ˜¯å¤§å®¶ä¸€ç›´æ²¡ç»ƒè¿‡çš„æ¥è¯èƒ½åŠ›',
            'ç›´åˆ°å‰æ®µæ—¶é—´æ‰æ‡‚ï¼Œæ€§æ ¼ä¸èƒ½å†³å®šç¤¾äº¤ï¼ŒçœŸæ­£èµ·ä½œç”¨çš„æ˜¯æ¥è¯èƒ½åŠ›',
            'ç›´åˆ°æ…¢æ…¢æ‰æ„è¯†åˆ°ï¼Œå½±å“ç¤¾äº¤çš„ï¼Œä¸æ˜¯å†…å‘å¤–å‘ï¼Œè€Œæ˜¯é—²èŠèƒ½åŠ›'
        ],
        
        // ç”¨æˆ·è§è¯æ¨¡æ¿
        'testimony_templates': [
            'æœ‰ä¸ªè¯»è€…ä¸Šå‘¨å‘Šè¯‰æˆ‘ï¼Œå¥¹ç”¨ä¹¦é‡Œçš„æ–¹æ³•ï¼Œå½“åŒäº‹è¯´"æˆ‘å®¶å°å­©æ„Ÿå†’äº†"æ—¶ï¼Œä¸å†åªæ˜¯è¯´"å¤šå–çƒ­æ°´"ï¼Œè€Œæ˜¯é—®"ç°åœ¨å¥½ç‚¹äº†å—ï¼Ÿä½ æ˜¨å¤©æ˜¯ä¸æ˜¯è¿˜åŠ ç­åˆ°å¾ˆæ™šï¼Ÿ"æ²¡æƒ³åˆ°åŒäº‹ç«‹åˆ»æ‰“å¼€äº†è¯åŒ£å­',
            'æœ‰ä¸ªè¯»è€…å‰å‡ å¤©è·Ÿæˆ‘è¯´ï¼Œä»–ç”¨ä¹¦é‡Œçš„æ–¹æ³•ï¼Œæœ‹å‹è¯´"å‘¨æœ«å»çˆ¬å±±äº†"æ—¶ï¼Œä¸å†åªå›"å“¦"ï¼Œè€Œæ˜¯é—®"å“ªåº§å±±å•Šï¼Ÿé£æ™¯æ€ä¹ˆæ ·ï¼Ÿ"æ²¡æƒ³åˆ°èŠäº†åŠä¸ªå°æ—¶',
            'æœ‰ä¸ªè¯»è€…æœ€è¿‘å‘Šè¯‰æˆ‘ï¼Œå¥¹ç”¨ä¹¦é‡Œçš„æ–¹æ³•ï¼Œé‡åˆ°å†·åœºæ—¶ç”¨"å¯¹äº†ï¼Œä½ åˆšæ‰è¯´çš„é‚£ä¸ª..."æ¥å»¶ç»­è¯é¢˜ï¼Œæ²¡æƒ³åˆ°æ•ˆæœç‰¹åˆ«å¥½',
            'æœ‰ä¸ªè¯»è€…ä¸Šå‘¨åé¦ˆï¼Œä»–ç”¨ä¹¦é‡Œçš„å…³é”®è¯å»¶ä¼¸æ³•ï¼ŒæŠŠ"æˆ‘æœ€è¿‘åœ¨å¥èº«"å»¶ä¼¸æˆäº†ä¸€ä¸ªåŠå°æ—¶çš„å¯¹è¯ï¼Œæ²¡æƒ³åˆ°è¿™ä¹ˆç®¡ç”¨'
        ],
        
        // ç”¨æˆ·è§è¯é‡‘å¥åº“
        'testimony_quotes': [
            'åŸæ¥æ¥è¯çœŸçš„æœ‰æ–¹æ³•ï¼Œä¸æ˜¯é å¤©ç”Ÿä¼šè¯´',
            'ç»ˆäºä¸ç”¨å†å°´å°¬åœ°å†·åœºäº†',
            'ä»¥å‰èŠå¤©ä¸‰å¥è¯å°±ç»“æŸï¼Œç°åœ¨èƒ½èŠåŠå°æ—¶',
            'åŸæ¥æ¥è¯æ²¡é‚£ä¹ˆéš¾ï¼Œå¯¹æ–¹åè€Œè§‰å¾—æˆ‘å¾ˆæ‡‚å€¾å¬',
            'å’Œé™Œç”ŸäººèŠå¤©ä¹Ÿèƒ½å¾ˆè‡ªç„¶ï¼Œä¸å†åƒä»¥å‰é‚£æ ·ç´§å¼ äº†',
            'ç°åœ¨å’Œäººç›¸å¤„è½»æ¾å¤šäº†ï¼Œä¸å†é‚£ä¹ˆç´§å¼ '
        ],
        
        // äº§å“å¼•å…¥å¥å¼
        'product_intro': [
            'è¿™æœ¬ã€Šæ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—ã€‹å°±æ˜¯ä»è¿™æ ·çš„è§‚å¯Ÿé‡Œè¯ç”Ÿçš„ã€‚æˆ‘æŠŠè¿™äº›å¹´æ”¶é›†çš„æ¥è¯æ–¹æ³•éƒ½å†™è¿›äº†è¿™æœ¬ä¹¦é‡Œï¼Œä»å…³é”®è¯å»¶ä¼¸åˆ°ç»†èŠ‚è¿½é—®ï¼Œä»åœºæ™¯è”æƒ³åˆ°è¯é¢˜æ¥åŠ›',
            'è¿™æœ¬ã€Šæ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—ã€‹å°±æ˜¯ä»è¿™æ ·çš„è§‚å¯Ÿé‡Œè¯ç”Ÿçš„ã€‚æˆ‘æŠŠè¿™äº›å¹´æ”¶é›†çš„å®ç”¨å¯¹è¯æ–¹æ³•éƒ½å†™è¿›äº†è¿™æœ¬ä¹¦é‡Œï¼Œä»æ¥è¯å…¬å¼åˆ°è¯é¢˜å»¶ç»­ï¼Œä»æƒ…ç»ªå…±é¸£åˆ°å…³ç³»ç»´æŠ¤',
            'è¿™æœ¬ã€Šæ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—ã€‹å°±æ˜¯ä»è¿™æ ·çš„è§‚å¯Ÿé‡Œè¯ç”Ÿçš„ã€‚æˆ‘æŠŠè¿™äº›å¹´æ•´ç†çš„ç¤¾äº¤æ–¹æ³•éƒ½å†™è¿›äº†è¿™æœ¬ä¹¦é‡Œï¼Œä»ç ´å†°è¯æœ¯åˆ°æ·±åº¦å¯¹è¯ï¼Œä»å†·åœºæ•‘æ´åˆ°å…³ç³»å‡æ¸©'
        ],
        
        // æ•ˆæœæè¿°ç»„åˆåº“
        'effects': [
            'èŠå¤©ä¸å†·åœºã€æ¥è¯ä¸å°´å°¬ã€è®©å¯¹è¯è‡ªç„¶å»¶ç»­',
            'å‘Šåˆ«å°´å°¬å†·åœºã€è¯é¢˜èƒ½å»¶ç»­ã€æ°›å›´æ›´è½»æ¾',
            'å’Œäººç›¸å¤„æ›´è‡ªåœ¨ã€èŠå¤©æ›´è½»æ¾ã€å…³ç³»æ›´èæ´½',
            'ä¸å†å®³æ€•ç¤¾äº¤ã€èŠå¤©èƒ½å»¶ç»­ã€æ°”æ°›æ›´èæ´½',
            'è½»æ¾åº”å¯¹ç¤¾äº¤ã€è‡ªç„¶èå…¥åœˆå­ã€ä¸å†å®³æ€•èŠå¤©'
        ]
    },
    
    // ========== æ¨¡æ¿2ï¼šä¸ªäººæˆé•¿æ•…äº‹å¼ ==========
    'template2': {
        // ç¬¬1æ®µï¼šæˆé•¿èƒŒæ™¯ï¼ˆ8ç§è¡¨è¾¾ï¼‰
        'section1': [
            'æˆ‘ä»¬ä»å°å°±æ˜¯é€šè¿‡å¯¹çˆ¶æ¯ã€å‘¨å›´äººçš„è§‚å¯Ÿæ¨¡ä»¿é€æ¸å­¦ä¹ åˆ°ç›¸å…³çš„çŸ¥è¯†å’Œèƒ½åŠ›ï¼Œä½†å¾ˆå¤šçˆ¶æ¯è‡ªå·±ä¹Ÿæ˜¯è€å®äººï¼Œä¸èƒ½æ•™ç»™å­©å­ç¤¾ä¼šä¸Šçš„äººæƒ…ä¸–æ•…ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬é•¿å¤§åï¼Œå°±ä¼šåœ¨ç¤¾äº¤ä¸­ç¢°å£',
            'å¤§å¤šæ•°äººçš„ç¤¾äº¤èƒ½åŠ›éƒ½æ˜¯ä»å®¶åº­ä¸­ä¹ å¾—çš„ï¼Œé€šè¿‡è§‚å¯Ÿå’Œæ¨¡ä»¿çˆ¶æ¯ã€èº«è¾¹äººçš„è¡Œä¸ºæ–¹å¼ã€‚å¯æƒœå¾ˆå¤šçˆ¶æ¯æœ¬èº«å°±ä¸æ“…é•¿äººæƒ…ä¸–æ•…ï¼Œæ²¡åŠæ³•ç»™å­©å­ä¼ æˆè¿™æ–¹é¢çš„ç»éªŒï¼Œå¯¼è‡´æˆ‘ä»¬æˆå¹´ååœ¨ç¤¾äº¤ä¸­é¢‘é¢‘å—æŒ«',
            'å›æƒ³èµ·æ¥ï¼Œç¤¾äº¤æŠ€èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šæ¥è‡ªå®¶åº­æ•™è‚²ï¼Œå­©å­ä¼šæ¨¡ä»¿çˆ¶æ¯å’Œå‘¨å›´äººçš„è¨€è¡Œä¸¾æ­¢ã€‚ä½†å¦‚æœçˆ¶æ¯è‡ªå·±å°±ä¸æ‡‚äººæƒ…ä¸–æ•…ï¼Œè‡ªç„¶æ— æ³•æ•™ç»™å­©å­è¿™äº›æœ¬é¢†ï¼Œäºæ˜¯é•¿å¤§ååœ¨äººé™…äº¤å¾€ä¸­å°±å®¹æ˜“å¤„å¤„ç¢°å£'
        ],
        
        // ç¬¬2æ®µï¼šä¸ªäººç»å†ï¼ˆ8ç§è¡¨è¾¾ï¼‰
        'section2': [
            'å› ä¸ºæ›¾ç»æˆ‘ä¹Ÿæ˜¯ä¸€ä¸ªå†…å‘ã€æ•æ„Ÿçš„äººï¼Œä¸å–„æ²Ÿé€šï¼Œä¸ä¼šå¤„äº‹ï¼Œç»å†äº†å¾ˆå¤šæŒ«æŠ˜',
            'è¯´å®è¯ï¼Œæˆ‘ä»¥å‰ä¹Ÿæ˜¯ä¸ªä¸å–„è¨€è¾çš„äººï¼Œä¸çŸ¥é“è¯¥æ€ä¹ˆè¡¨è¾¾ï¼Œç¢°äº†ä¸å°‘é’‰å­',
            'å¦ç™½è®²ï¼Œè¿‡å»çš„æˆ‘ä¹Ÿä¸æ‡‚å¦‚ä½•ç¤¾äº¤ï¼Œä¸ä¼šæ¥äº‹ï¼Œåƒè¿‡å¾ˆå¤šäº'
        ],
        
        // ç¬¬3æ®µï¼šæ”¹å˜è¿‡ç¨‹ï¼ˆ8ç§è¡¨è¾¾ï¼‰
        'section3': [
            'æ‰€ä»¥ï¼Œæˆ‘èŠ±äº†å››å¹´æ—¶é—´ï¼Œæ…¢æ…¢æ”¹å˜è‡ªå·±ï¼Œç°åœ¨æˆ‘å°†æˆ‘çš„ç»éªŒæ€»ç»“æˆäº†ä¸€ä»½äºŒåä¸‡å­—ï¼Œå…±å…­åè¯¾çš„ç¤¾ä¼šåŒ–æ”»ç•¥æŒ‡å—',
            'ä¸ºæ­¤ï¼Œæˆ‘ç”¨äº†å››å¹´æ—¶é—´æ‘¸ç´¢æ€»ç»“ï¼ŒæŠŠè‡ªå·±çš„ç»éªŒæ•´ç†æˆäº†ä¸€ä»½20ä¸‡å­—ã€åŒ…å«60å ‚è¯¾çš„ç¤¾ä¼šåŒ–æå‡æŒ‡å—',
            'ç»è¿‡å››å¹´çš„å®è·µå’Œæ€»ç»“ï¼Œæˆ‘æŠŠè¿™äº›å¿ƒå¾—ä½“ä¼šæ•´ç†æˆäº†ä¸€ä»½å®Œæ•´çš„ç¤¾ä¼šåŒ–æŒ‡å—ï¼Œæ€»å…±20ä¸‡å­—ï¼ŒåŒ…å«60ä¸ªä¸“é¢˜è¯¾ç¨‹'
        ],
        
        // ç¬¬4æ®µï¼šå¸Œæœ›ä¼ é€’ï¼ˆ8ç§è¡¨è¾¾ï¼‰
        'section4': [
            'å¸Œæœ›ä½ ä¹Ÿèƒ½å’Œæˆ‘ä¸€æ ·ï¼Œä»å†…å‘æ•æ„Ÿå˜æˆè½è½å¤§æ–¹ï¼Œå°‘ç»å†ä¸€äº›æŒ«æŠ˜ï¼Œæ‡‚å¾—ä¸ºäººå¤„äº‹çš„æ–¹æ³•',
            'å¦‚æœä½ ä¹Ÿæœ‰åŒæ ·çš„å›°æ‰°ï¼Œè¿™ä»½æŒ‡å—æˆ–è®¸èƒ½å¸®åˆ°ä½ ï¼Œè®©ä½ ä»ä¸å–„è¡¨è¾¾å˜æˆä¾ƒä¾ƒè€Œè°ˆï¼Œå°‘èµ°ä¸€äº›å¼¯è·¯ï¼ŒæŒæ¡ä¸ºäººå¤„ä¸–çš„æ™ºæ…§',
            'æŠŠè¿™äº›ç»éªŒåˆ†äº«å‡ºæ¥ï¼Œå¸Œæœ›èƒ½è®©æ›´å¤šäººå°‘èµ°å¼¯è·¯ï¼Œä»ä¸ä¼šæ¥äº‹å˜æˆæ¸¸åˆƒæœ‰ä½™ï¼ŒçœŸæ­£æ‡‚å¾—ä¸ºäººå¤„ä¸–çš„åˆ†å¯¸'
        ],
        
        // ç¬¬5æ®µï¼šäº§å“äº®ç‚¹ï¼ˆ4ä¸ªï¼‰
        'section5_highlights': [
            'æŒ‡å—æ¶µç›–20ä¸‡å­—å†…å®¹ï¼Œå…±60ä¸ªå®ç”¨è¯¾ç¨‹ï¼Œä»åŸºç¡€ç¤¾äº¤åˆ°é«˜é˜¶äººæƒ…ä¸–æ•…ï¼Œç³»ç»Ÿæ€§åœ°å¸®ä½ è¡¥ä¸Šè¿™å ‚ç¤¾ä¼šåŒ–çš„è¯¾',
            'å†…å®¹å®æˆ˜æ€§å¼ºï¼Œæ¯ä¸ªæ–¹æ³•éƒ½æœ‰å…·ä½“åœºæ™¯å’Œè¯æœ¯ï¼Œæ‹¿æ¥å°±èƒ½ç”¨ï¼Œä¸æ˜¯ç©ºæ´çš„ç†è®ºï¼Œè€Œæ˜¯çœŸæ­£è½åœ°çš„æ–¹æ³•',
            'æŒ‡å—è¿˜åŒ…å«å¤§é‡çœŸå®æ¡ˆä¾‹ï¼Œæœ‰è¯»è€…åé¦ˆï¼Œæœ‰æˆ‘è‡ªå·±çš„ç»å†ï¼Œè®©ä½ çœ‹åˆ°è¿™äº›æ–¹æ³•åœ¨å®é™…ç”Ÿæ´»ä¸­æ˜¯æ€ä¹ˆèµ·ä½œç”¨çš„',
            'æ›´é‡è¦çš„æ˜¯ï¼Œè¿™ä»½æŒ‡å—ä¼šæŒç»­æ›´æ–°ï¼Œæˆ‘ä¼šæ ¹æ®è¯»è€…åé¦ˆå’Œæ–°çš„å®è·µç»éªŒä¸æ–­å®Œå–„å†…å®¹ï¼Œè®©å®ƒè¶Šæ¥è¶Šå®ç”¨'
        ],
        
        // ç¬¬6æ®µï¼šé€‚åˆäººç¾¤ï¼ˆ8ç»„ï¼‰
        'section6': [
            'å¦‚æœä½ ä¹Ÿæ˜¯ä¸å–„è¨€è¾çš„äººã€ä¸çŸ¥é“æ€ä¹ˆå’Œäººç›¸å¤„ã€æ€»æ˜¯åœ¨ç¤¾äº¤ä¸­åƒäºã€æƒ³æ”¹å˜å´ä¸çŸ¥é“ä»å“ªå¼€å§‹ã€æ¸´æœ›å»ºç«‹æ›´å¥½çš„äººé™…å…³ç³»ã€å¸Œæœ›åœ¨ç¤¾äº¤ä¸­æ›´è‡ªä¿¡ä»å®¹ï¼Œè¿™ä»½æŒ‡å—å°±æ˜¯ä¸ºä½ å‡†å¤‡çš„',
            'å¦‚æœä½ ä¹Ÿç»å¸¸ç¤¾äº¤å°´å°¬ã€ä¸æ‡‚äººæƒ…ä¸–æ•…ã€åœ¨äººé™…äº¤å¾€ä¸­ç¢°å£ã€æƒ³æå‡ç¤¾ä¼šåŒ–èƒ½åŠ›ã€å¸Œæœ›æ”¹å–„äººé™…å…³ç³»ã€æ¸´æœ›åœ¨ç¤¾äº¤ä¸­æ¸¸åˆƒæœ‰ä½™ï¼Œè¿™ä»½æŒ‡å—ä¼šå¸®åˆ°ä½ ',
            'å¦‚æœä½ ä¹Ÿä¸ä¼šæ¥è¯ã€èŠå¤©æ€»æ˜¯å†·åœºã€ä¸æ‡‚é¥­å±€ç¤¼ä»ªã€æƒ³å­¦ä¹ ç¤¾äº¤æ–¹æ³•ã€å¸Œæœ›æå‡äººé™…èƒ½åŠ›ã€æ¸´æœ›åœ¨ç¤¾äº¤ä¸­æ›´è½»æ¾ï¼Œè¿™ä»½æŒ‡å—é€‚åˆä½ '
        ]
    },
    
    // ========== æ¨¡æ¿3ï¼šæ–¹æ³•å¹²è´§å¼ ==========
    'template3': {
        'é˜²å¥—è¯': {
            'section1': [
                'å®å­ä»¬ï¼Œæ˜¯ä¸æ˜¯ç»å¸¸é‡åˆ°é‚£ç§ä¸å¥½å›ç­”ã€è¢«äººå¥—è¯çš„å°´å°¬åœºé¢ï¼Ÿé—®æ”¶å…¥ã€é—®æ„Ÿæƒ…ã€æ‰“å¬éšç§â€¦ä¸è¯´å§ï¼Œæ˜¾å¾—ä½ å°æ°”ï¼›è¯´äº†å§ï¼Œè‡ªå·±å¿ƒé‡Œæ†‹å±ˆ',
                'æœ‹å‹ä»¬ï¼Œæœ‰æ²¡æœ‰ç¢°åˆ°è¿‡è¢«å¥—è¯çš„æƒ…å†µï¼Ÿåˆ«äººæ—æ•²ä¾§å‡»ã€æ‰“å¬æ¶ˆæ¯ã€è¯•æ¢éšç§â€¦å›ç­”å§è§‰å¾—ä¸å¦¥ï¼Œä¸å›ç­”å§åˆæ˜¾å¾—ä¸è¿‘äººæƒ…',
                'å§å¦¹ä»¬ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿé‡åˆ°è¿‡è¢«å¥—è¯çš„æ—¶åˆ»ï¼Ÿæœ‰äººåˆºæ¢ã€å…«å¦ã€æ‰“å¬ç§äº‹â€¦è¯´å§ä¸åˆé€‚ï¼Œä¸è¯´å§åˆæ‹…å¿ƒå¾—ç½ªäºº'
            ],
            'section2': [
                'ä»Šå¤©æˆ‘åˆ†äº«ä¸€ä¸ªè¶…å¥½ç”¨çš„é˜²å¥—è¯æ–¹æ³•ï¼Œå¤§å®¶æ€ä¹ˆåº”å¯¹åˆ«äººçš„å¥—è¯ï¼š',
                'è·Ÿå¤§å®¶åˆ†äº«å‡ ä¸ªæˆ‘å¸¸ç”¨çš„é˜²å¥—è¯æ–¹æ³•ï¼Œæ—¢ä¿æŠ¤éšç§åˆä¸ä¼¤æ„Ÿæƒ…ï¼š',
                'ç»™å¤§å®¶ä»‹ç»å‡ ä¸ªç‰¹åˆ«ç®¡ç”¨çš„é˜²å¥—è¯æ–¹æ³•ï¼Œç¤¼è²Œåˆä¸å¤±åˆ†å¯¸ï¼š'
            ],
            'methods': [
                {
                    title: 'åªè®²äº‹å®ä¸è¯„ä»·',
                    variants: [
                        'é€‚ç”¨äºé€‰æ‹©æ€§é—®é¢˜ï¼Œåªé™ˆè¿°äº‹å®å¹¶å¸¦ä¸Šç»†èŠ‚ï¼Œä¸åšåˆ†æè¯„ä»·ï¼Œè¢«è¿½é—®å°±ç”¨ç¤¼è²Œä½†æ•·è¡çš„å›ç­”ï¼Œé¿å…è½ä¸‹æŠŠæŸ„ã€‚æ¯”å¦‚æœ‰äººé—®"å¼ ä¸‰æ€ä¹ˆæ ·"ï¼Œå¯ä»¥è¯´"å¼ ä¸‰ä¹‹å‰å¸®è¿‡æˆ‘ï¼Œæœ€è¿‘ä¸šç»©å¾ˆçªå‡º"',
                        'é‡åˆ°é€‰æ‹©æ€§é—®é¢˜ï¼Œåªè¯´äº‹å®åŠ ç»†èŠ‚ï¼Œä¸åšä»»ä½•è¯„ä»·ï¼Œè¢«è¿½é—®å°±æ•·è¡å›åº”ã€‚ä¾‹å¦‚åˆ«äººé—®"ä½ è§‰å¾—æå››æ€ä¹ˆæ ·"ï¼Œå°±è¯´"æå››å·¥ä½œå¾ˆåŠªåŠ›ï¼Œå‰å‡ å¤©è¿˜åŠ ç­åˆ°å¾ˆæ™š"'
                    ]
                },
                {
                    title: 'åªè¯´å¤§æ¦‚ä¸è¯´ç»†èŠ‚',
                    variants: [
                        'é€‚ç”¨äºæ¶‰åŠä¸ªäººéšç§å’Œéœ€ä¿å¯†çš„äº‹ï¼Œç”¨"å’Œå¤§å®¶å·®ä¸å¤š"è¿™ç±»æ¨¡ç³Šå›ç­”',
                        'æ¶‰åŠéšç§æˆ–ä¿å¯†å†…å®¹ï¼Œç”¨æ¨¡ç³Šå›ç­”å¸¦è¿‡ï¼Œæ¯”å¦‚"è¿˜è¡Œå§""å·®ä¸å¤š""å’Œå¤§å®¶ä¸€æ ·"'
                    ]
                },
                {
                    title: 'å€Ÿå£æ‰“æ–­å¯¹è¯',
                    variants: [
                        'é€‚ç”¨äºå„ç§æƒ…å¢ƒï¼Œè‹¥å¯¹æ–¹æ‰“ç ´ç ‚é”…é—®åˆ°åº•ï¼Œå°±æ‰¾ç†ç”±ç¦»å¼€ï¼Œå¦‚"çªç„¶æƒ³èµ·æ¥è°è°è°æœ‰äº‹è¦äº¤ä»£æˆ‘""äº‹æƒ…æ¯”è¾ƒæ€¥ï¼Œç­‰æˆ‘å¹²å®Œå†è¯´"',
                        'å¯¹æ–¹è¿½é—®ä¸åœæ—¶ï¼Œæ‰¾ä¸ªç†ç”±ç»“æŸå¯¹è¯ï¼Œæ¯”å¦‚"åˆšæƒ³èµ·æ¥è¿˜æœ‰ä»¶æ€¥äº‹""ç­‰ä¼šå„¿æœ‰ä¸ªç”µè¯è¦æ‰“"'
                    ]
                },
                {
                    title: 'ç”¨é—®é¢˜å›ç­”é—®é¢˜',
                    variants: [
                        'æ ¸å¿ƒæ˜¯ç”¨é—®é¢˜è½¬ç§»æ³¨æ„åŠ›ã€åå®¢ä¸ºä¸»ï¼Œè¯¢é—®å¯¹æ–¹é—®é¢˜çš„å‡ºå‘ç‚¹ï¼Œæˆ–å›ç­”åæŠŠé—®é¢˜æŠ›å›ï¼Œå¦‚"ä½ ä¸ºä»€ä¹ˆçªç„¶é—®è¿™ä¸ªå‘€""ä½ è§‰å¾—å‘¢"',
                        'ç”¨åé—®è½¬ç§»è¯é¢˜ï¼ŒæŠŠé—®é¢˜æŠ›å›ç»™å¯¹æ–¹ï¼Œæ¯”å¦‚"ä½ æ€ä¹ˆæƒ³åˆ°é—®è¿™ä¸ª""ä½ è§‰å¾—åº”è¯¥æ€ä¹ˆæ ·"'
                    ]
                },
                {
                    title: 'å¤¸å¼ å›ç­”',
                    variants: [
                        'å›ç­”é—®é¢˜ä¸åˆ»æ¿ï¼Œå¯å¾€å¤§æˆ–å¾€å°å¤¸å¼ ï¼Œç”šè‡³ä¸¤æ¬¡å¤¸å¼ ï¼Œè¾¾æˆå¼€ç©ç¬‘æ•ˆæœã€‚æ¯”å¦‚é—®"å·¥èµ„å¤šå°‘"ï¼Œå…ˆè¯´"ä¸åˆ°åä¸‡"ï¼Œå†ç­”"ä¸¤åƒäºŒ"',
                        'ç”¨å¤¸å¼ æ‰‹æ³•å›åº”ï¼Œåˆ¶é€ ç©ç¬‘æ•ˆæœï¼Œæ¯”å¦‚é—®æ”¶å…¥ï¼Œå…ˆè¯´"ä¸Šç™¾ä¸‡"å†è¯´"å¼€ç©ç¬‘çš„ï¼Œå°±æ™®é€šå·¥èµ„"'
                    ]
                }
            ],
            'section4': [
                'æˆ‘èŠ±äº†å››å¹´æ—¶é—´ï¼Œä»ä¸ä¼šæ‹’ç»åˆ°æ‡‚å¾—ä¿æŠ¤è‡ªå·±ï¼ŒæŠŠè¿™äº›ç»éªŒæ•´ç†æˆäº†ä¸€ä»½äºŒåä¸‡å­—ã€å…­åè¯¾çš„ç¤¾ä¼šåŒ–æŒ‡å—ï¼Œæ‡‚å¾—è‡ªæˆ‘ä¿æŠ¤ã€äººé™…äº¤å¾€ã€è¿˜æœ‰å­¦æ ¡é‡Œæ²¡æœ‰æ•™è¿‡çš„äººæƒ…ä¸–æ•…ï¼Œå¸¦ä½ å¿«é€Ÿæå‡ç¤¾ä¼šåŒ–èƒ½åŠ›',
                'ç»è¿‡å››å¹´çš„æ‘¸ç´¢å’Œæ€»ç»“ï¼Œæˆ‘ä»ä¸€ä¸ªä¸æ‡‚æ‹’ç»çš„è€å®äººæˆé•¿ä¸ºç°åœ¨çš„æ ·å­ï¼ŒèŠ±äº†å‡ ä¸ªæœˆæ—¶é—´æŠŠå¿ƒå¾—ç¼–æˆäº†ä¸€æœ¬20ä¸‡å­—ã€60å ‚è¯¾çš„ç¤¾ä¼šåŒ–å®æˆ˜æ‰‹å†Œï¼Œæ¶µç›–è‡ªæˆ‘ä¿æŠ¤ã€äººé™…å…³ç³»ã€äººæƒ…ä¸–æ•…ç­‰å†…å®¹ï¼Œå¸®ä½ ç³»ç»Ÿæå‡ç¤¾ä¼šåŒ–æ°´å¹³'
            ]
        }
    }
};

// ========== éšæœºæŠ½å–å‡½æ•° ==========
function randomPick(array) {
    if (!array || array.length === 0) return '';
    return array[Math.floor(Math.random() * array.length)];
}
// ========== å°çº¢ä¹¦çƒ­æœè¯åº“ ==========
const XIAOHONGSHU_HOT_KEYWORDS = {
    // ç¤¾äº¤ç±»çƒ­æœè¯
    'ç¤¾äº¤': [
        'ç¤¾äº¤ç„¦è™‘', 'ç¤¾æè‡ªæ•‘', 'ç¤¾äº¤æŠ€å·§', 'ç¤¾äº¤è¾¾äºº', 'ç¤¾äº¤ææƒ§ç—‡',
        'ç¤¾äº¤ç‰›é€¼ç—‡', 'ç¤¾äº¤åœºåˆ', 'ç¤¾äº¤ç¤¼ä»ª', 'ç¤¾äº¤åœˆ', 'ç¤¾äº¤èƒ½åŠ›'
    ],
    'äººæƒ…ä¸–æ•…': [
        'äººæƒ…ä¸–æ•…', 'èŒåœºäººæƒ…ä¸–æ•…', 'äººæƒ…å¾€æ¥', 'äººæƒ…ç¤¼ä»ª', 'äººæƒ…å†·æš–',
        'ä¸–æ•…åœ†æ»‘', 'äººæƒ…ç»ƒè¾¾', 'äººæƒ…ç¤¾ä¼š', 'æƒ…å•†é«˜æ‰‹', 'é«˜æƒ…å•†'
    ],
    'æ¥è¯': [
        'æ¥è¯æŠ€å·§', 'æ¥è¯èƒ½åŠ›', 'æ¥è¯æœ¯', 'èŠå¤©æŠ€å·§', 'èŠå¤©è¯æœ¯',
        'é—²èŠèƒ½åŠ›', 'ä¼šèŠå¤©', 'èŠå¤©é«˜æ‰‹', 'è¯é¢˜å»¶ç»­', 'ç ´å†°è¯æœ¯'
    ],
    'å†·åœº': [
        'å†·åœºæ•‘æ˜Ÿ', 'å†·åœºæ•‘æ´', 'ä¸å†·åœº', 'æ°”æ°›æ´»è·ƒ', 'åœºé¢æ§åˆ¶',
        'è¯é¢˜æ•‘åœº', 'å°´å°¬åŒ–è§£', 'é¿å…å†·åœº', 'æ°›å›´åˆ¶é€ ', 'è¯é¢˜ç‹'
    ],
    'èŒåœº': [
        'èŒåœºç”Ÿå­˜', 'èŒåœºç¤¾äº¤', 'èŒåœºç¤¼ä»ª', 'èŒåœºæ–°äºº', 'èŒåœºå¹²è´§',
        'ä¸Šç­æ—', 'èŒåœºäºº', 'åŠå…¬å®¤ç¤¾äº¤', 'èŒåœºæ™ºæ…§', 'èŒåœºæ³•åˆ™'
    ],
    'ä¸ºäººå¤„äº‹': [
        'ä¸ºäººå¤„äº‹', 'åšäººåšäº‹', 'å¤„äº‹ä¹‹é“', 'å¾…äººæ¥ç‰©', 'è¿›é€€æœ‰åº¦',
        'åˆ†å¯¸æ„Ÿ', 'ç•Œé™æ„Ÿ', 'è¾¹ç•Œæ„Ÿ', 'è‡ªæˆ‘ä¿æŠ¤', 'æ‹’ç»è‰ºæœ¯'
    ],
    'ç©ä¸ç†Ÿ': [
        'ç¤¾äº¤è¾¹ç•Œ', 'ç©ä¸ç†Ÿ', 'ä¿æŒè·ç¦»', 'ç¤¾äº¤åˆ†å¯¸', 'ç•Œé™æ¸…æ™°',
        'ä¸è¶Šç•Œ', 'å®ˆåˆ†å¯¸', 'ç¤¾äº¤è·ç¦»', 'è¾¹ç•Œæ„è¯†', 'è‡ªæˆ‘ä¿æŠ¤'
    ],
    'é˜²å¥—è¯': [
        'é˜²å¥—è¯', 'åå¥—è·¯', 'ä¿æŠ¤éšç§', 'æ‹’ç»è¯•æ¢', 'è§æ‹›æ‹†æ‹›',
        'ä¸è¢«å¥—è¯', 'åä¾¦å¯Ÿ', 'éšç§ä¿æŠ¤', 'é˜²æ‰“æ¢', 'å®ˆå£å¦‚ç“¶'
    ],
    'é¥­å±€': [
        'é¥­å±€åº”å¯¹', 'æ•¬é…’è¯æœ¯', 'é¤æ¡Œç¤¼ä»ª', 'é¥­å±€è§„çŸ©', 'åº”é…¬æŠ€å·§',
        'é…’æ¡Œæ–‡åŒ–', 'åº§æ¬¡ç¤¼ä»ª', 'æ•¬é…’ç¤¼ä»ª', 'é¥­å±€ç¤¾äº¤', 'é¤æ¡Œè§„çŸ©'
    ],
    'é€šç”¨': [
        'å®ç”¨å¹²è´§', 'ç”Ÿæ´»æ™ºæ…§', 'æˆé•¿ç¬”è®°', 'è‡ªæˆ‘æå‡', 'ä¸ªäººæˆé•¿',
        'å˜ä¼˜ç§€', 'è‡ªæˆ‘è¿›åŒ–', 'æå‡è‡ªå·±', 'æ™®é€šäººé€†è¢­', 'è‰æ ¹é€†è¢­'
    ]
};

// ========== å†…å®¹å…³é”®è¯æ˜ å°„ ==========
const CONTENT_KEYWORD_MAP = {
    'æ¥è¯': ['æ¥è¯', 'èŠå¤©', 'å¯¹è¯', 'äº¤è°ˆ', 'è¯é¢˜', 'å»¶ç»­'],
    'å†·åœº': ['å†·åœº', 'å°´å°¬', 'æ²‰é»˜', 'æ°”æ°›', 'æ•‘åœº', 'ç ´å†°'],
    'äººæƒ…ä¸–æ•…': ['äººæƒ…', 'ä¸–æ•…', 'ç¤¼å°šå¾€æ¥', 'é€ç¤¼', 'å›ç¤¼', 'æ„Ÿè°¢'],
    'ç©ä¸ç†Ÿ': ['é™Œç”Ÿ', 'ç†Ÿæ‚‰', 'å…³ç³»', 'è·ç¦»', 'è¾¹ç•Œ', 'åˆ†å¯¸'],
    'é˜²å¥—è¯': ['å¥—è¯', 'è¯•æ¢', 'æ‰“æ¢', 'éšç§', 'æ‹’ç»', 'ä¿æŠ¤'],
    'é¥­å±€': ['é¥­å±€', 'æ•¬é…’', 'åº”é…¬', 'èšé¤', 'é¤æ¡Œ', 'åº§æ¬¡'],
    'èŒåœº': ['èŒåœº', 'åŒäº‹', 'é¢†å¯¼', 'å·¥ä½œ', 'åŠå…¬å®¤', 'ä¸Šç­'],
    'ç¤¾äº¤': ['ç¤¾äº¤', 'ç¤¾æ', 'äº¤é™…', 'äººé™…', 'å…³ç³»', 'åœˆå­']
};

// ========== æ™ºèƒ½ç”ŸæˆSEOè¯é¢˜æ ‡ç­¾ ==========
function generateSEOTags(title, topic, content) {
    const tags = [];
    
    // 1. ä»æ ‡é¢˜æå–1-2ä¸ªå…³é”®è¯ï¼ˆä¼˜å…ˆï¼‰
    const titleKeywords = extractKeywordsFromTitle(title);
    tags.push(...titleKeywords.slice(0, 2));
    
    // 2. æ ¹æ®é€‰é¢˜æ·»åŠ 2-3ä¸ªçƒ­æœè¯
    const topicHotWords = XIAOHONGSHU_HOT_KEYWORDS[topic] || XIAOHONGSHU_HOT_KEYWORDS['é€šç”¨'];
    const selectedHotWords = randomPickMultiple(topicHotWords, 3);
    tags.push(...selectedHotWords);
    
    // 3. ä»æ­£æ–‡å†…å®¹æå–ç›¸å…³è¯ï¼ˆ1-2ä¸ªï¼‰
    const contentKeywords = extractKeywordsFromContent(content, topic);
    tags.push(...contentKeywords.slice(0, 2));
    
    // 4. å›ºå®šæ·»åŠ å“ç‰Œè¯
    tags.push('æ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—');
    
    // 5. å»é‡å¹¶é™åˆ¶8ä¸ª
    const uniqueTags = [...new Set(tags)];
    const finalTags = uniqueTags.slice(0, 8);
    
    // 6. å¦‚æœä¸è¶³8ä¸ªï¼Œä»é€šç”¨çƒ­æœè¡¥å……
    while (finalTags.length < 8) {
        const fillerWord = randomPick(XIAOHONGSHU_HOT_KEYWORDS['é€šç”¨']);
        if (!finalTags.includes(fillerWord)) {
            finalTags.push(fillerWord);
        }
    }
    
    // 7. æ ¼å¼åŒ–ä¸ºè¯é¢˜æ ‡ç­¾
    return finalTags.map(tag => `#${tag}`).join(' ');
}

// ========== ä»æ ‡é¢˜æå–å…³é”®è¯ ==========
function extractKeywordsFromTitle(title) {
    const keywords = [];
    
    // é¢„å®šä¹‰çš„å…³é”®è¯åº“ï¼ˆä¼˜å…ˆåŒ¹é…é•¿è¯ï¼‰
    const priorityWords = [
        'äººæƒ…ä¸–æ•…', 'ç¤¾ä¼šåŒ–', 'ç¤¾äº¤æ™ºæ…§', 'æ¥è¯èƒ½åŠ›', 'ä¸ºäººå¤„äº‹',
        'é«˜æƒ…å•†', 'å†·åœº', 'é¥­å±€', 'èŒåœº', 'ç¤¾æ', 'ç©ä¸ç†Ÿ',
        'å¥—è¯', 'æ‹’ç»', 'è¾¹ç•Œæ„Ÿ', 'åˆ†å¯¸', 'ç¤¼ä»ª', 'åº”é…¬'
    ];
    
    // ä»é•¿åˆ°çŸ­åŒ¹é…ï¼Œé¿å…"ç¤¾ä¼š"åŒ¹é…äº†"ç¤¾ä¼šåŒ–"
    for (const word of priorityWords) {
        if (title.includes(word) && !keywords.includes(word)) {
            keywords.push(word);
            if (keywords.length >= 2) break;
        }
    }
    
    // å¦‚æœè¿˜æ²¡æ‰¾åˆ°ï¼Œå°è¯•çŸ­è¯
    if (keywords.length < 2) {
        const shortWords = ['ç¤¾äº¤', 'èŠå¤©', 'å¯¹è¯', 'å…³ç³»', 'æœ‹å‹', 'åŒäº‹', 'é¢†å¯¼'];
        for (const word of shortWords) {
            if (title.includes(word) && !keywords.includes(word)) {
                keywords.push(word);
                if (keywords.length >= 2) break;
            }
        }
    }
    
    return keywords;
}

// ========== ä»å†…å®¹æå–å…³é”®è¯ ==========
function extractKeywordsFromContent(content, topic) {
    const keywords = [];
    const topicKeywords = CONTENT_KEYWORD_MAP[topic] || [];
    
    // ç»Ÿè®¡å…³é”®è¯å‡ºç°æ¬¡æ•°
    const wordCount = {};
    for (const word of topicKeywords) {
        const count = (content.match(new RegExp(word, 'g')) || []).length;
        if (count > 0) {
            wordCount[word] = count;
        }
    }
    
    // æŒ‰å‡ºç°æ¬¡æ•°æ’åºï¼Œå–å‰2ä¸ª
    const sortedWords = Object.entries(wordCount)
        .sort((a, b) => b[1] - a[1])
        .map(item => item[0])
        .slice(0, 2);
    
    return sortedWords;
}
function randomPickMultiple(array, count) {
    if (!array || array.length === 0) return [];
    const shuffled = [...array].sort(() => 0.5 - Math.random());
    return shuffled.slice(0, Math.min(count, array.length));
}
        const CONFIG = {
            SECRET_KEY: "xiaohongshu_2025_secret_key_change_me",
            ADMIN_PASSWORD: "lss900201",
            API_BASE_URL: "https://api.gptsapi.net/v1/messages",
            MODEL: "claude-sonnet-4-20250514",
            SENSITIVE_WORDS: {
                'æŠ€å·§': 'æ–¹æ³•',
                'å¸®åŠ©': 'ååŠ©',
                'æ²¦ä¸º': 'å˜æˆ',
                'æŠ€èƒ½': 'èƒ½åŠ›',
                'ä¸è¶³': 'ä¸å¤Ÿ',
                'è¯¾ç¨‹': 'ç« èŠ‚',
                'å·¥ä½œ': 'å·¥åš',
                'èŠ‚è¯¾': 'èŠ‚å†…å®¹',
                'èŒåœº': 'ä¸Šç­',
                'æŠ€æœ¯': 'æ–¹å¼'
            }
        };
        
        // ========== è®¾å¤‡æŒ‡çº¹ ==========
        function getDeviceFingerprint() {
            // æ”¶é›†æµè§ˆå™¨ä¿¡æ¯
            const components = [
                navigator.userAgent,
                navigator.language,
                screen.width + 'x' + screen.height,
                screen.colorDepth,
                new Date().getTimezoneOffset(),
                !!window.sessionStorage,
                !!window.localStorage
            ];
            
            // CanvasæŒ‡çº¹
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillStyle = '#f60';
                ctx.fillRect(0, 0, 100, 50);
                ctx.fillStyle = '#069';
                ctx.fillText('Device Fingerprint', 2, 15);
                components.push(canvas.toDataURL());
            } catch (e) {
                components.push('canvas-error');
            }
            
            // ç”ŸæˆæŒ‡çº¹
            const fingerprint = components.join('###');
            return CryptoJS.MD5(fingerprint).toString();
        }
        
        // ========== ä½¿ç”¨è¯´æ˜æ¨¡æ€æ¡† ==========
        function showUserGuide() {
            document.getElementById('guideModal').classList.add('show');
        }
        
        function closeGuideModal() {
            document.getElementById('guideModal').classList.remove('show');
        }
        
        // ========== ä¸‹è½½æ¨¡æ¿ ==========
        
        
        // ========== é€‰é¢˜å…³é”®è¯åº“ ==========
        const TOPIC_KEYWORDS = {
            'æ¥è¯': ['æ¥è¯', 'é—²èŠ', 'é—²è°ˆ', 'èŠå¤©', 'å¯¹è¯', 'äº¤è°ˆ'],
            'äººæƒ…ä¸–æ•…': ['äººæƒ…ä¸–æ•…', 'ç­”è°¢', 'æ„Ÿè°¢', 'ç¤¼å°šå¾€æ¥', 'é€ç¤¼', 'å›ç¤¼'],
            'ç¤¾äº¤æ™ºæ…§': ['ç¤¾äº¤', 'äº¤é™…', 'åº”é…¬', 'ç¤¾ä¼šåŒ–', 'äººé™…å…³ç³»', 'å…³ç³»'],
            'ç©ä¸ç†Ÿ': ['ç©ä¸ç†Ÿ', 'è¾¹ç•Œæ„Ÿ', 'è·ç¦»', 'åˆ†å¯¸', 'ç•Œé™'],
            'é˜²å¥—è¯': ['å¥—è¯', 'è¯æœ¯', 'è¢«å¥—è·¯', 'è¯•æ¢', 'æ‰“æ¢'],
            'é€šç”¨': []
        };
        
        // ========== æ¨¡æ¿ç±»å‹å…³é”®è¯ ==========
        const TEMPLATE_KEYWORDS = {
            'æ¨¡æ¿1': ['æŠ€å·§', 'æ–¹æ³•', 'ç§˜è¯€', 'è¯€çª', 'å¦™æ‹›'],
            'æ¨¡æ¿2': ['ä¸ºä»€ä¹ˆ', 'åŸå› ', 'çœŸç›¸', 'æœ¬è´¨', 'å†…å¹•'],
            'æ¨¡æ¿3': ['å¦‚ä½•', 'æ€ä¹ˆ', 'æ€æ ·', 'æ•™ä½ ', 'å­¦ä¼š']
        };
        
        // ========== æ™ºèƒ½åŒ¹é…é€‰é¢˜ ==========
        function smartMatchTopic(title) {
            for (const [topic, keywords] of Object.entries(TOPIC_KEYWORDS)) {
                if (topic === 'é€šç”¨') continue;
                for (const keyword of keywords) {
                    if (title.includes(keyword)) {
                        return topic;
                    }
                }
            }
            return 'é€šç”¨';
        }
        
        // ========== æ™ºèƒ½åŒ¹é…æ¨¡æ¿ç±»å‹ ==========
        function smartMatchTemplate(title) {
            for (const [template, keywords] of Object.entries(TEMPLATE_KEYWORDS)) {
                for (const keyword of keywords) {
                    if (title.includes(keyword)) {
                        return template;
                    }
                }
            }
            return 'æ¨¡æ¿1';  // é»˜è®¤æ¨¡æ¿1
        }
        
        // ========== å¤„ç†æ ‡é¢˜æ–‡ä»¶ ==========
        let titleData = null;
        
        function handleTitleFile() {
            const file = document.getElementById('titleFile').files[0];
            const status = document.getElementById('titleFileInfo');
            
            if (!file) {
                status.classList.add('hidden');
                document.getElementById('assignBtn').disabled = true;
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];
                    titleData = XLSX.utils.sheet_to_json(sheet);
                    
                    if (!titleData[0] || !titleData[0]['æ ‡é¢˜']) {
                        showStatus(status, 'âŒ Excelæ–‡ä»¶å¿…é¡»åŒ…å«"æ ‡é¢˜"åˆ—', 'error');
                        document.getElementById('assignBtn').disabled = true;
                        return;
                    }
                    
                    showStatus(status, `âœ… æ–‡ä»¶: ${file.name} | æ ‡é¢˜æ•°: ${titleData.length} æ¡`, 'success');
                    document.getElementById('assignBtn').disabled = false;
                } catch (error) {
                    showStatus(status, 'âŒ æ–‡ä»¶è¯»å–å¤±è´¥ï¼š' + error.message, 'error');
                    document.getElementById('assignBtn').disabled = true;
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        // ========== æ™ºèƒ½åˆ†é…é€‰é¢˜ ==========
        function assignTopics() {
            if (!titleData) return;
            
            const status = document.getElementById('assignStatus');
            const container = document.getElementById('assignProgress');
            container.classList.remove('hidden');
            
            showStatus(status, 'æ­£åœ¨æ™ºèƒ½åˆ†é…é€‰é¢˜...', 'info');
            
            // æ™ºèƒ½åˆ†é…ï¼ˆè¿‡æ»¤ç©ºæ ‡é¢˜ï¼‰
            const results = titleData
                .filter(row => {
                    const title = (row['æ ‡é¢˜'] || '').trim();
                    return title.length > 0;  // åªä¿ç•™éç©ºæ ‡é¢˜
                })
                .map((row, index) => {
                    const title = row['æ ‡é¢˜'] || '';
                    const template = smartMatchTemplate(title);
                    const topic = smartMatchTopic(title);
                    
                    return {
                        'åºå·': index + 1,
                        'æ¨¡æ¿ç±»å‹': template,
                        'æ ‡é¢˜': title,
                        'é€‰é¢˜': topic,
                        'ç”Ÿæˆæ•°é‡': 1
                    };
                });
            
            // ä¸‹è½½ç»“æœ
            const ws = XLSX.utils.json_to_sheet(results);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "åˆ†é…ç»“æœ");
            
            ws['!cols'] = [
                { wch: 8 },   // åºå·
                { wch: 12 },  // æ¨¡æ¿ç±»å‹
                { wch: 50 },  // æ ‡é¢˜
                { wch: 15 },  // é€‰é¢˜
                { wch: 12 }   // ç”Ÿæˆæ•°é‡
            ];
            
            const timestamp = new Date().toISOString().replace(/[:-]/g, '').split('.')[0].replace('T', '_');
            XLSX.writeFile(wb, `é€‰é¢˜åˆ†é…ç»“æœ_${timestamp}.xlsx`);
            
            const nextSteps = `âœ… æ™ºèƒ½åˆ†é…å®Œæˆï¼å…±${results.length}æ¡æ ‡é¢˜

ğŸ“¥ å·²è‡ªåŠ¨ä¸‹è½½ï¼šé€‰é¢˜åˆ†é…ç»“æœ_${timestamp}.xlsx

ğŸ“‹ æ–‡ä»¶åŒ…å«åˆ—ï¼š
â€¢ åºå·
â€¢ æ¨¡æ¿ç±»å‹ï¼ˆç³»ç»Ÿæ™ºèƒ½åŒ¹é…ï¼‰
â€¢ æ ‡é¢˜ï¼ˆæ‚¨å¡«å†™çš„ï¼‰
â€¢ é€‰é¢˜ï¼ˆç³»ç»Ÿæ™ºèƒ½åŒ¹é…ï¼‰
â€¢ ç”Ÿæˆæ•°é‡ï¼ˆé»˜è®¤1ï¼Œå¯ä¿®æ”¹ï¼‰

ğŸ” ä¸‹ä¸€æ­¥æ“ä½œï¼š
1. æ‰“å¼€ä¸‹è½½çš„Excelæ–‡ä»¶
2. æ£€æŸ¥"æ¨¡æ¿ç±»å‹"å’Œ"é€‰é¢˜"æ˜¯å¦å‡†ç¡®
3. å¦‚éœ€ä¿®æ”¹ï¼Œç›´æ¥åœ¨Excelä¸­æ”¹
4. å¦‚æƒ³ç”Ÿæˆå¤šæ¡ï¼Œä¿®æ”¹"ç”Ÿæˆæ•°é‡"ä¸º2ã€3ã€5ç­‰
5. ä¿å­˜åï¼Œä¸Šä¼ åˆ°ä¸‹æ–¹"ğŸ“ æ‰¹é‡ç”Ÿæˆ"åŒºåŸŸ

ğŸ’¡ æç¤ºï¼šå¦‚æœåˆ†é…ä¸å‡†ç¡®ï¼Œå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ï¼
`;
            showStatus(status, nextSteps.replace(/\n/g, '<br>'), 'success');
        }
        
        // ========== æ•æ„Ÿè¯è¿‡æ»¤ ==========
        function filterSensitiveWords(text) {
            let filtered = text;
            
            // 1. è¿‡æ»¤æ•æ„Ÿè¯
            const words = CONFIG.SENSITIVE_WORDS || {};
            for (const word in words) {
                const replacement = words[word];
                filtered = filtered.replace(new RegExp(word, 'g'), replacement);
            }
            
            // 2. ç§»é™¤Markdownæ ¼å¼ç¬¦å·
            filtered = filtered.replace(/\*\*([^*]+)\*\*/g, '$1');  // åŠ ç²—
            filtered = filtered.replace(/__([^_]+)__/g, '$1');          // ä¸‹åˆ’çº¿
            filtered = filtered.replace(/\*([^*]+)\*/g, '$1');        // æ–œä½“
            
            // 3. ç¡®ä¿ä¹¦åæ­£ç¡®
            filtered = filtered.replace(/ã€Šé«˜æƒ…å•†[^ã€‹]+ã€‹/g, 'ã€Šæ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—ã€‹');
            filtered = filtered.replace(/ã€Šç¤¾äº¤[^ã€‹]+ã€‹/g, 'ã€Šæ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—ã€‹');
            
            return filtered;
        }
        
        // ========== æå–è¯é¢˜æ ‡ç­¾ ==========
        function extractTags(text) {
            const tagRegex = /#[^\s#]+/g;
            const tags = text.match(tagRegex);
            if (tags) {
                const cleanText = text.replace(tagRegex, '').trim();
                return { content: cleanText, tags: tags.join(' ') };
            }
            return { content: text, tags: '' };
        }
        
        
        // ========== ä¸‹è½½ç©ºç™½æ¨¡æ¿ ==========
        function downloadBlankTemplate() {
            // åˆ›å»ºç©ºç™½æ¨¡æ¿ï¼šåªæœ‰æ ‡é¢˜åˆ—
            const templateData = [
                { 'æ ‡é¢˜': 'ä¼šåŠäº‹çš„å¥³å­©å­æœ‰å¤šå‰å®³' },
                { 'æ ‡é¢˜': 'ä½ çš„ç­”è°¢æ–¹å¼æš´éœ²äº†ä½ çš„ç¤¾äº¤æ®µä½' },
                { 'æ ‡é¢˜': 'ä¸ºä»€ä¹ˆä½ åœ¨äººé™…å…³ç³»é‡Œæ€»æŒ¨æ‰“' },
                { 'æ ‡é¢˜': 'æ‹¥æœ‰é—²è°ˆåŠ›æ˜¯ç¤¾ä¼šåŒ–ç¨‹åº¦é«˜çš„ä½“ç°' },
                { 'æ ‡é¢˜': '' }  // ç©ºè¡Œä¾›ç”¨æˆ·ç»§ç»­å¡«å†™
            ];
            
            const ws = XLSX.utils.json_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "æ ‡é¢˜åˆ—è¡¨");
            ws['!cols'] = [{ wch: 55 }];  // åŠ å®½åˆ—
            
            XLSX.writeFile(wb, 'æ­¥éª¤1_ç©ºç™½æ¨¡æ¿.xlsx');
            
            alert('âœ… å·²ä¸‹è½½ç©ºç™½æ¨¡æ¿ï¼\n\nä¸‹ä¸€æ­¥ï¼š\n1. æ‰“å¼€Excelæ–‡ä»¶\n2. åœ¨"æ ‡é¢˜"åˆ—å¡«å†™æ‚¨çš„æ ‡é¢˜\n3. ä¿å­˜åç‚¹å‡»"æ™ºèƒ½åˆ†é…é€‰é¢˜"ä¸Šä¼ ');
        }
        
        // ========== æ˜¾ç¤ºé€‰é¢˜åˆ†é…å·¥å…· ==========
        function showTopicAssigner() {
            const section = document.getElementById('topicAssignerSection');
            if (section) {
                section.classList.remove('hidden');
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        function downloadTemplate() {
            // åˆ›å»ºç¤ºä¾‹æ•°æ®
            const templateData = [
                { 'æ ‡é¢˜': 'ä¼šåŠäº‹çš„å¥³å­©å­æœ‰å¤šå‰å®³', 'é€‰é¢˜': 'æ¥è¯' },
                { 'æ ‡é¢˜': 'ä½ çš„ç­”è°¢æ–¹å¼æš´éœ²äº†ä½ çš„ç¤¾äº¤æ®µä½', 'é€‰é¢˜': 'äººæƒ…ä¸–æ•…' },
                { 'æ ‡é¢˜': 'ä¸ºä»€ä¹ˆä½ åœ¨äººé™…å…³ç³»é‡Œæ€»æŒ¨æ‰“', 'é€‰é¢˜': 'ç¤¾äº¤æ™ºæ…§' },
                { 'æ ‡é¢˜': 'æ‹¥æœ‰é—²è°ˆåŠ›æ˜¯ç¤¾ä¼šåŒ–ç¨‹åº¦é«˜çš„ä½“ç°', 'é€‰é¢˜': 'é€šç”¨' }
            ];
            
            // åˆ›å»ºå·¥ä½œç°¿
            const ws = XLSX.utils.json_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "æ ‡é¢˜æ¨¡æ¿");
            
            // è®¾ç½®åˆ—å®½
            ws['!cols'] = [
                { wch: 50 },  // æ ‡é¢˜åˆ—
                { wch: 15 }   // é€‰é¢˜åˆ—
            ];
            
            // ä¸‹è½½
            XLSX.writeFile(wb, 'å°çº¢ä¹¦æ ‡é¢˜æ¨¡æ¿.xlsx');
        }
        
        // ========== æ¿€æ´»ç ç”Ÿæˆä¸éªŒè¯ ==========
        function generateActivationCode(businessType, expireDate) {
            const businessMap = {
                'social': 'SOCIAL',
                'ring': 'RING',
                'travel': 'TRAVEL',
                'psychology': 'PSY',
                'all': 'ALL'
            };
            
            const businessCode = businessMap[businessType];
            const dateStr = expireDate.replace(/-/g, '');
            
            const timestamp = Date.now().toString();
            const random = Math.random().toString(36).substring(2, 6).toUpperCase();
            const checkString = `${businessCode}${dateStr}${timestamp}${random}${CONFIG.SECRET_KEY}`;
            const checkHash = CryptoJS.MD5(checkString).toString().toUpperCase();
            const checkCode = checkHash.substring(0, 4);
            
            return `XHS-${businessCode}-${dateStr}-${checkCode}`;
        }
        
        function validateActivationCode(code) {
            const parts = code.trim().toUpperCase().split('-');
            
            const businessMap = {
                'SOCIAL': 'ç¤¾ä¼šåŒ–æŒ‡å—',
                'RING': 'æˆ’æŒ‡',
                'TRAVEL': 'æ—…æ¸¸',
                'PSY': 'å¿ƒç†æµ‹è¯•',
                'ALL': 'å…¨åŠŸèƒ½ç‰ˆ'
            };
            
            // æ”¯æŒä¸¤ç§æ ¼å¼ï¼š
            // æ—§æ ¼å¼ï¼šXHS-BUSINESS-DATE-CHECK (4æ®µ)
            // æ–°æ ¼å¼ï¼šXHS-BUSINESS-DATE-USERID-CHECK (5æ®µ)
            
            if (parts.length === 4 && parts[0] === 'XHS') {
                // æ—§æ ¼å¼å…¼å®¹ï¼ˆæ— è®¾å¤‡ç»‘å®šï¼‰
                const [prefix, businessCode, dateStr, checkCode] = parts;
                
                const checkString = `${businessCode}${dateStr}${CONFIG.SECRET_KEY}`;
                const expectedCheck = CryptoJS.MD5(checkString).toString().toUpperCase().substring(0, 4);
                
                if (checkCode !== expectedCheck) {
                    return { valid: false, message: 'æ¿€æ´»ç æ— æ•ˆ' };
                }
                
                const year = parseInt(dateStr.substring(0, 4));
                const month = parseInt(dateStr.substring(4, 6));
                const day = parseInt(dateStr.substring(6, 8));
                const expireDate = new Date(year, month - 1, day);
                
                if (new Date() > expireDate) {
                    return { valid: false, message: `æ¿€æ´»ç å·²è¿‡æœŸï¼ˆ${year}-${month}-${day}ï¼‰` };
                }
                
                const businessName = businessMap[businessCode] || businessCode;
                const expireDateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                return {
                    valid: true,
                    business: businessName,
                    expireDate: expireDateStr,
                    userId: 'legacy',
                    message: 'æ¿€æ´»ç æœ‰æ•ˆ'
                };
                
            } else if (parts.length === 5 && parts[0] === 'XHS') {
                // æ–°æ ¼å¼ï¼šæ”¯æŒç”¨æˆ·IDå’Œè®¾å¤‡ç»‘å®š
                const [prefix, businessCode, dateStr, userId, checkCode] = parts;
                
                // éªŒè¯æ ¡éªŒç ï¼ˆuserIdç”¨å°å†™è®¡ç®—ï¼‰
                const checkString = `${businessCode}${dateStr}${userId.toLowerCase()}${CONFIG.SECRET_KEY}`;
                const expectedCheck = CryptoJS.MD5(checkString).toString().toUpperCase().substring(0, 4);
                
                if (checkCode !== expectedCheck) {
                    return { valid: false, message: 'æ¿€æ´»ç æ— æ•ˆ' };
                }
                
                // éªŒè¯æ—¥æœŸ
                const year = parseInt(dateStr.substring(0, 4));
                const month = parseInt(dateStr.substring(4, 6));
                const day = parseInt(dateStr.substring(6, 8));
                const expireDate = new Date(year, month - 1, day);
                
                if (new Date() > expireDate) {
                    return { valid: false, message: `æ¿€æ´»ç å·²è¿‡æœŸï¼ˆ${year}-${month}-${day}ï¼‰` };
                }
                
                // è®¾å¤‡ç»‘å®šæ£€æŸ¥
                const boundUserId = localStorage.getItem('boundUserId');
                const deviceFingerprint = getDeviceFingerprint();
                const boundDevice = localStorage.getItem('boundDevice');
                
                // æ£€æŸ¥æ˜¯å¦å·²ç»‘å®šå…¶ä»–ç”¨æˆ·
                if (boundUserId && boundUserId !== userId.toLowerCase()) {
                    return { 
                        valid: false, 
                        message: `æ­¤è®¾å¤‡å·²ç»‘å®šè´¦å·: ${boundUserId}ã€‚å¦‚éœ€æ›´æ¢è¯·æ¸…é™¤æµè§ˆå™¨æ•°æ®åé‡è¯•` 
                    };
                }
                
                // æ£€æŸ¥æ¿€æ´»ç æ˜¯å¦å·²åœ¨å…¶ä»–è®¾å¤‡ä½¿ç”¨
                if (boundDevice && boundDevice !== deviceFingerprint) {
                    return { 
                        valid: false, 
                        message: 'æ­¤æ¿€æ´»ç å·²åœ¨å…¶ä»–è®¾å¤‡æ¿€æ´»ã€‚ä¸€ä¸ªæ¿€æ´»ç åªèƒ½ç»‘å®šä¸€ä¸ªè®¾å¤‡' 
                    };
                }
                
                // ä¿å­˜ç»‘å®šä¿¡æ¯
                localStorage.setItem('boundUserId', userId.toLowerCase());
                localStorage.setItem('boundDevice', deviceFingerprint);
                
                const businessName = businessMap[businessCode] || businessCode;
                const expireDateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                return {
                    valid: true,
                    business: businessName,
                    expireDate: expireDateStr,
                    userId: userId.toLowerCase(),
                    message: `æ¿€æ´»æˆåŠŸï¼å·²ç»‘å®šè´¦å·: ${userId.toLowerCase()}`
                };
                
            } else {
                return { valid: false, message: 'æ¿€æ´»ç æ ¼å¼é”™è¯¯ï¼ˆåº”ä¸ºXHS-XXX-XXX-XXXæˆ–XHS-XXX-XXX-XXX-XXXï¼‰' };
            }
        }
        
        // ========== ç®¡ç†å‘˜åŠŸèƒ½ ==========
        function showAdminModal() {
            document.getElementById('adminModal').classList.add('show');
        }
        
        function closeAdminModal() {
            document.getElementById('adminModal').classList.remove('show');
        }
        
        function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            const status = document.getElementById('adminLoginStatus');
            
            if (password === CONFIG.ADMIN_PASSWORD) {
                showStatus(status, 'âœ… ç™»å½•æˆåŠŸ', 'success');
                setTimeout(() => {
                    document.getElementById('adminLogin').classList.add('hidden');
                    document.getElementById('adminPanel').classList.remove('hidden');
                    loadCodeHistory();
                }, 500);
            } else {
                showStatus(status, 'âŒ å¯†ç é”™è¯¯', 'error');
            }
        }
        
        function adminLogout() {
            document.getElementById('adminLogin').classList.remove('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('adminPassword').value = '';
            document.getElementById('adminLoginStatus').classList.add('hidden');
        }
        
        function setQuickDate(days) {
            const date = new Date();
            date.setDate(date.getDate() + days);
            document.getElementById('expireDate').value = date.toISOString().split('T')[0];
        }
        
        function generateCode() {
            const businessType = document.getElementById('businessType').value;
            const expireDate = document.getElementById('expireDate').value;
            
            if (!expireDate) {
                alert('è¯·é€‰æ‹©åˆ°æœŸæ—¥æœŸ');
                return;
            }
            
            const code = generateActivationCode(businessType, expireDate);
            
            document.getElementById('generatedCode').textContent = code;
            document.getElementById('codeDisplay').classList.remove('hidden');
            
            saveCodeToHistory(code, businessType, expireDate);
            loadCodeHistory();
        }
        
        function copyCode() {
            const code = document.getElementById('generatedCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('æ¿€æ´»ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }
        
        function saveCodeToHistory(code, businessType, expireDate) {
            let history = JSON.parse(localStorage.getItem('codeHistory') || '[]');
            history.unshift({
                code,
                businessType,
                expireDate,
                generatedAt: new Date().toISOString()
            });
            localStorage.setItem('codeHistory', JSON.stringify(history.slice(0, 50)));
        }
        
        function loadCodeHistory() {
            const history = JSON.parse(localStorage.getItem('codeHistory') || '[]');
            const container = document.getElementById('codeList');
            
            if (history.length === 0) {
                container.innerHTML = '<p style="color: #999; text-align: center;">æš‚æ— æ¿€æ´»ç è®°å½•</p>';
                return;
            }
            
            const businessMap = {
                'social': 'ç¤¾ä¼šåŒ–æŒ‡å—',
                'ring': 'æˆ’æŒ‡',
                'travel': 'æ—…æ¸¸',
                'psychology': 'å¿ƒç†æµ‹è¯•',
                'all': 'å…¨éƒ¨ä¸šåŠ¡çº¿'
            };
            
            container.innerHTML = history.map(item => `
                <div class="code-item">
                    <div style="font-weight: bold; font-family: 'Courier New'; color: #667eea; margin-bottom: 5px;">
                        ${item.code}
                    </div>
                    <div style="font-size: 12px; color: #666;">
                        ä¸šåŠ¡: ${businessMap[item.businessType]} | 
                        åˆ°æœŸ: ${item.expireDate} | 
                        ç”Ÿæˆ: ${new Date(item.generatedAt).toLocaleString()}
                    </div>
                </div>
            `).join('');
        }
        
        // ========== ç”¨æˆ·ç«¯ï¼šæ¿€æ´»åŠŸèƒ½ ==========
        function activate() {
            const code = document.getElementById('activationCode').value.trim();
            const status = document.getElementById('activationStatus');
            
            if (!code) {
                showStatus(status, 'è¯·è¾“å…¥æ¿€æ´»ç ', 'error');
                return;
            }
            
            const result = validateActivationCode(code);
            
            if (result.valid) {
                localStorage.setItem('activation', JSON.stringify({
                    code,
                    business: result.business,
                    expireDate: result.expireDate,
                    userId: result.userId || 'legacy'
                }));
                
                showStatus(status, `âœ… ${result.message}`, 'success');
                
                setTimeout(() => {
                    document.getElementById('activationSection').classList.add('hidden');
                    document.getElementById('activatedInfo').classList.remove('hidden');
                    document.getElementById('apiSection').classList.remove('hidden');
                    
                    document.getElementById('businessInfo').textContent = result.business;
                    document.getElementById('expireInfo').textContent = result.expireDate;
                    
                    // æ˜¾ç¤ºç”¨æˆ·IDï¼ˆå¦‚æœæœ‰ï¼‰
                    if (result.userId && result.userId !== 'legacy') {
                        document.getElementById('businessInfo').textContent += ` (${result.userId})`;
                    }
                }, 1000);
            } else {
                showStatus(status, `âŒ ${result.message}`, 'error');
            }
        }
        
        function resetActivation() {
            if (confirm('ç¡®å®šè¦é‡æ–°æ¿€æ´»å—ï¼Ÿå½“å‰é…ç½®å°†è¢«æ¸…é™¤ã€‚')) {
                localStorage.removeItem('activation');
                localStorage.removeItem('apiKey');
                location.reload();
            }
        }
        
        // ========== ç”¨æˆ·ç«¯ï¼šAPIé…ç½® ==========
        function saveApiKey() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const status = document.getElementById('apiStatus');
            
            if (!apiKey) {
                showStatus(status, 'è¯·è¾“å…¥API Key', 'error');
                return;
            }
            
            localStorage.setItem('apiKey', apiKey);
            showStatus(status, 'âœ… API Keyå·²ä¿å­˜', 'success');
            
            setTimeout(() => {
                document.getElementById('generateSection').classList.remove('hidden');
            }, 500);
        }
        
        // ========== ç”¨æˆ·ç«¯ï¼šæ–‡ä»¶å¤„ç† ==========
        let excelData = null;
        
        function handleFileSelect() {
            const file = document.getElementById('excelFile').files[0];
            const status = document.getElementById('fileInfo');
            
            if (!file) {
                status.classList.add('hidden');
                document.getElementById('generateBtn').disabled = true;
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];
                    excelData = XLSX.utils.sheet_to_json(sheet);
                    
                    if (!excelData[0] || !excelData[0]['æ ‡é¢˜']) {
                        showStatus(status, 'âŒ Excelæ–‡ä»¶å¿…é¡»åŒ…å«"æ ‡é¢˜"åˆ—ï¼Œå»ºè®®ä¸‹è½½æ¨¡æ¿å¡«å†™', 'error');
                        document.getElementById('generateBtn').disabled = true;
                        return;
                    }
                    
                    showStatus(status, `âœ… æ–‡ä»¶: ${file.name} | æ•°æ®: ${excelData.length} æ¡`, 'success');
                    document.getElementById('generateBtn').disabled = false;
                } catch (error) {
                    showStatus(status, 'âŒ æ–‡ä»¶è¯»å–å¤±è´¥ï¼š' + error.message, 'error');
                    document.getElementById('generateBtn').disabled = true;
                }
            };
            reader.readAsArrayBuffer(file);
        }
        
        // ========== ç”¨æˆ·ç«¯ï¼šç”ŸæˆåŠŸèƒ½ ==========
let isGenerating = false;
let pauseRequested = false;
let isPaused = false;
        
        
        // ========== æš‚åœåŠŸèƒ½ ==========
        function pauseGeneration() {
            pauseRequested = true;
            isPaused = true;
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'inline-block';
            addLog('â¸ï¸ å·²æš‚åœï¼Œæ­£åœ¨ä¿å­˜å·²ç”Ÿæˆçš„å†…å®¹...');
        }
        
        function resumeGeneration() {
            pauseRequested = false;
            isPaused = false;
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            addLog('â–¶ï¸ ç»§ç»­ç”Ÿæˆ...');
        }
        
        async function startGeneration() {
            if (isGenerating || !excelData) return;
            
            isGenerating = true;
            document.getElementById('generateBtn').disabled = true;
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('resumeBtn').style.display = 'none';
            pauseRequested = false;
            isPaused = false;
            document.getElementById('progressContainer').classList.remove('hidden');
            
            const log = document.getElementById('log');
            log.innerHTML = '';
            
            const apiKey = localStorage.getItem('apiKey');
            // è¿‡æ»¤ç©ºæ ‡é¢˜
            const validData = excelData.filter(row => {
                const title = (row['æ ‡é¢˜'] || '').toString().trim();
                return title.length > 0 && title !== 'NaN' && title !== 'nan';
            });
            
            if (validData.length === 0) {
                addLog('âŒ æ²¡æœ‰æœ‰æ•ˆçš„æ ‡é¢˜æ•°æ®ï¼');
                return;
            }
            
            addLog(`ğŸ“Š å…±${validData.length}ä¸ªæœ‰æ•ˆæ ‡é¢˜`);
            
            // è®¡ç®—æ€»ä»»åŠ¡æ•°ï¼ˆè€ƒè™‘ç”Ÿæˆæ•°é‡ï¼‰
            let totalTasks = 0;
            validData.forEach(row => {
                const count = parseInt(row['ç”Ÿæˆæ•°é‡']) || 1;
                totalTasks += count;
            });
            
            const results = [];
            let taskIndex = 0;
            
            for (let i = 0; i < validData.length; i++) {
const row = validData[i];
const title = row['æ ‡é¢˜'] || '';
const topic = row['é€‰é¢˜'] || 'é€šç”¨';
const templateType = row['æ¨¡æ¿ç±»å‹'] || 'æ¨¡æ¿1';  // æ–°å¢ï¼šè¯»å–æ¨¡æ¿ç±»å‹
const generateCount = parseInt(row['ç”Ÿæˆæ•°é‡']) || 1;
                
                // æ ¹æ®ç”Ÿæˆæ•°é‡å¾ªç¯
                for (let j = 0; j < generateCount; j++) {
                    taskIndex++;
                    
                    // æ£€æŸ¥æ˜¯å¦è¯·æ±‚æš‚åœ
                    if (pauseRequested) {
                        addLog('â¸ï¸ æš‚åœç”Ÿæˆï¼Œæ­£åœ¨ä¸‹è½½å·²ç”Ÿæˆçš„å†…å®¹...');
                        break;
                    }
                    
                    addLog(`[${taskIndex}/${totalTasks}] ${title.substring(0, 40)}... (ç¬¬${j+1}/${generateCount}æ¡)`);
                    
                    try {
let rawContent = await generateSingle(apiKey, title, topic, templateType);
                    
                    // è¿‡æ»¤æ•æ„Ÿè¯
                    rawContent = filterSensitiveWords(rawContent);
                    
                    // è¿‡æ»¤é€‰é¢˜ä¸­çš„æ•æ„Ÿè¯
                    const cleanTopic = filterSensitiveWords(topic);
                    
                    // æå–è¯é¢˜æ ‡ç­¾
                    const extracted = extractTags(rawContent);
                    
results.push({
    'åºå·': taskIndex,
    'æ¨¡æ¿ç±»å‹': templateType, 
    'æ ‡é¢˜': title,
    'é€‰é¢˜': cleanTopic,
    'æ–‡æ¡ˆ': extracted.content,
    'è¯é¢˜': extracted.tags,
    'å­—æ•°': extracted.content.length
                    });
                    addLog(`âœ“ æˆåŠŸ (${extracted.content.length}å­—)`);
                } catch (error) {
const cleanTopic = filterSensitiveWords(topic);
results.push({
    'åºå·': taskIndex,
    'æ¨¡æ¿ç±»å‹': templateType,  // æ–°å¢
    'æ ‡é¢˜': title,
    'é€‰é¢˜': cleanTopic,
    'æ–‡æ¡ˆ': `ç”Ÿæˆå¤±è´¥: ${error.message}`,
    'è¯é¢˜': '',
    'å­—æ•°': 0
                    });
                    addLog(`âœ— å¤±è´¥: ${error.message}`);
                }
                
                updateProgress(Math.round(taskIndex / totalTasks * 100));
                }
                
                // å¤–å±‚å¾ªç¯æ£€æŸ¥æš‚åœ
                if (pauseRequested) {
                    break;
                }
            }
            
            // ä¸‹è½½ç»“æœ
            downloadExcel(results);
localStorage.setItem('lastGeneratedResults', JSON.stringify(results));
localStorage.setItem('lastGeneratedTime', new Date().toLocaleString('zh-CN'));
            isGenerating = false;
            document.getElementById('generateBtn').disabled = false;
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'none';
            
            if (pauseRequested) {
                addLog(`\nâ¸ï¸ æš‚åœå®Œæˆï¼å·²ç”Ÿæˆ ${results.length} æ¡æ–‡æ¡ˆ`);
            } else {
                addLog('\nâœ… å…¨éƒ¨å®Œæˆï¼æ–‡ä»¶å·²ä¸‹è½½ã€‚');
                const downloadBtn = document.createElement('button');
downloadBtn.textContent = 'ğŸ“¥ é‡æ–°ä¸‹è½½ç»“æœ';
downloadBtn.style.cssText = `
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 16px;
    margin-top: 15px;
    font-weight: bold;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
`;
downloadBtn.onclick = () => downloadExcel(results);

const logDiv = document.getElementById('log');
logDiv.appendChild(downloadBtn);
            }
        }
        
async function generateSingle(apiKey, title, topic, templateType) {
    let filledPrompt = '';
    
    if (templateType === 'æ¨¡æ¿1') {
        // ä»ç´ æåº“éšæœºæŠ½å–
        const topicScenes = MATERIALS.template1.scenes[topic] || MATERIALS.template1.scenes['é€šç”¨'];
        const scenes = randomPickMultiple(topicScenes, 2);
        const viewpoint = randomPick(MATERIALS.template1.viewpoints);
        const testimonyTemplate = randomPick(MATERIALS.template1.testimony_templates);
        const testimonyQuote = randomPick(MATERIALS.template1.testimony_quotes);
        const productIntro = randomPick(MATERIALS.template1.product_intro);
        const effect = randomPick(MATERIALS.template1.effects);
        
        filledPrompt = `ä½ æ˜¯å°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆä¸“å®¶ã€‚è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ç´ æç”Ÿæˆæ–‡æ¡ˆï¼š

æ ‡é¢˜ï¼š${title}
é€‰é¢˜ï¼š${topic}

ã€ç¬¬1æ®µï¼šåœºæ™¯æè¿° 60-70å­—ã€‘
âš ï¸ å¼€å¤´ç»å¯¹ä¸è¦é‡å¤æ ‡é¢˜ï¼
è¯·ä»ä»¥ä¸‹åœºæ™¯ä¸­é€‰æ‹©1-2ä¸ªï¼Œç”¨å£è¯­åŒ–æ–¹å¼æè¿°ï¼š
"${scenes[0]}"
"${scenes[1] || scenes[0]}"
åŠ emojiï¼šğŸ˜®â€ğŸ’¨ ğŸ™‹â€â™€ï¸

ã€ç¬¬2æ®µï¼šè§‚ç‚¹é‡‘å¥ 50-60å­—ã€‘
å¿…é¡»ä½¿ç”¨è¿™ä¸ªè§‚ç‚¹ï¼š
"${viewpoint}"
å¯ä»¥ç¨å¾®æ‰©å±•ï¼ŒåŠ emojiï¼šğŸ’¡ ğŸ¯

ã€ç¬¬3æ®µï¼šç”¨æˆ·è§è¯ 120-140å­—ã€‘
ä½¿ç”¨è¿™ä¸ªæ¨¡æ¿ï¼š
"${testimonyTemplate}"
ç»“å°¾é‡‘å¥ï¼š"${testimonyQuote}"
å¥¹ç°åœ¨å…»æˆäº†ç”¨å…³å¿ƒå»¶ç»­è¯é¢˜çš„ä¹ æƒ¯ï¼Œæœ€å¤§çš„å˜åŒ–æ˜¯ï¼š"${testimonyQuote}"
åŠ emojiï¼šâ­ âœ¨ ğŸŒŸ

ã€ç¬¬4æ®µï¼šäº§å“å¼•å…¥ 80-100å­—ã€‘
ä½¿ç”¨è¿™æ®µï¼š
"${productIntro}...é‡Œé¢æ²¡æœ‰å¤æ‚ç†è®ºï¼Œå…¨æ˜¯èƒ½ç›´æ¥ç”¨çš„å¯¹è¯å…¬å¼"
åŠ emojiï¼šğŸ“– ğŸ’ª

ã€ç¬¬5æ®µï¼šæ•ˆæœæ‰¿è¯º 40-50å­—ã€‘
ä½¿ç”¨è¿™ä¸ªæ•ˆæœï¼š
"${effect}"
åŠ emojiï¼šğŸ‰ ğŸŠ

ã€å›ºå®šç»“å°¾ã€‘
å¦‚æœä½ ä¹Ÿæƒ³ç³»ç»Ÿå­¦ä¹ è¿™äº›ç¤¾äº¤æ™ºæ…§ï¼Œå¼ºçƒˆæ¨èã€Šæ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—ã€‹ã€‚

è¿™æ˜¯ä¸€å¥—ä¸“é—¨ä¸ºæ™®é€šäººæ‰“é€ çš„å®ç”¨ç¤¾äº¤æ‰‹å†Œï¼ŒåŒ…å«20ä¸‡å­—ç²¾åå¹²è´§å’Œ67è¯¾ç³»ç»Ÿè¯¾ï¼Œä»åŸºç¡€äººæƒ…ä¸–æ•…åˆ°é«˜çº§ç¤¾äº¤ç­–ç•¥ï¼Œå…¨æ–¹ä½å¢å¼ºä½ çš„ç¤¾ä¼šåŒ–èƒ½åŠ›ã€‚

ğŸ” æŒ‡å—åœ¨æˆ‘å°çº¢ä¹¦åº—é“ºé‡Œå•¦ï¼
ç‚¹å‡»æˆ‘çš„ä¸»é¡µè¿›å…¥åº—é“ºï¼Œå³å¯æŸ¥çœ‹è¯¦æƒ…

ã€è¯é¢˜æ ‡ç­¾ã€‘
#ç¤¾ä¼šåŒ– #äººæƒ…ä¸–æ•… #ç¤¾ä¼šåŒ–è®­ç»ƒ #ä¸Šç­äººæƒ…ä¸–æ•… #ä¸ºäººå¤„äº‹ #æ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å— #é«˜æƒ…å•†ç¤¾äº¤ #å®ç”¨å¹²è´§

ã€è¦æ±‚ã€‘
âœ… ä¸¥æ ¼ä½¿ç”¨æä¾›çš„ç´ æ
âœ… ä¸è¦é‡å¤æ ‡é¢˜
âœ… å¤§é‡emojiï¼ˆ30+ï¼‰
âœ… å£è¯­åŒ–ã€åƒæœ‹å‹èŠå¤©
âœ… æ€»å­—æ•°550-650å­—`;
        
    } else if (templateType === 'æ¨¡æ¿2') {
        // æ¨¡æ¿2ç´ ææŠ½å–
        const bg = randomPick(MATERIALS.template2.section1);
        const exp = randomPick(MATERIALS.template2.section2);
        const change = randomPick(MATERIALS.template2.section3);
        const hope = randomPick(MATERIALS.template2.section4);
        const highlights = randomPickMultiple(MATERIALS.template2.section5_highlights, 2);
        const audience = randomPick(MATERIALS.template2.section6);
        
        filledPrompt = `ä½ æ˜¯å°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆä¸“å®¶ã€‚è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ç´ æç”Ÿæˆæ–‡æ¡ˆï¼š

æ ‡é¢˜ï¼š${title}

ã€ç¬¬1æ®µï¼šæˆé•¿èƒŒæ™¯ 70-80å­—ã€‘
âš ï¸ å¼€å¤´ç»å¯¹ä¸è¦é‡å¤æ ‡é¢˜ï¼
ä½¿ç”¨è¿™æ®µï¼š
"${bg}"
åŠ emojiï¼šğŸ˜®â€ğŸ’¨ ğŸ™‹â€â™€ï¸

ã€ç¬¬2æ®µï¼šä¸ªäººç»å† 40-50å­—ã€‘
ä½¿ç”¨è¿™æ®µï¼š
"${exp}"
åŠ emojiï¼šğŸ˜ ğŸ˜”

ã€ç¬¬3æ®µï¼šæ”¹å˜è¿‡ç¨‹ 60-70å­—ã€‘
ä½¿ç”¨è¿™æ®µï¼š
"${change}"
åŠ emojiï¼šğŸ’ª âœ¨

ã€ç¬¬4æ®µï¼šå¸Œæœ›ä¼ é€’ 50-60å­—ã€‘
ä½¿ç”¨è¿™æ®µï¼š
"${hope}"
åŠ emojiï¼šğŸŒŸ â­

ã€ç¬¬5æ®µï¼šäº§å“äº®ç‚¹ 100-120å­—ã€‘
ä½¿ç”¨è¿™ä¸¤ä¸ªäº®ç‚¹ï¼š
1. "${highlights[0]}"
2. "${highlights[1]}"
åŠ emojiï¼šğŸ“š ğŸ¯

ã€ç¬¬6æ®µï¼šé€‚åˆäººç¾¤ 70-80å­—ã€‘
ä½¿ç”¨è¿™æ®µï¼š
"${audience}"
åŠ emojiï¼šğŸ¯ ğŸ’«

ã€å›ºå®šç»“å°¾+è¯é¢˜ã€‘åŒæ¨¡æ¿1

ã€è¦æ±‚ã€‘
âœ… ä¸¥æ ¼ä½¿ç”¨æä¾›çš„ç´ æ
âœ… ä¸è¦é‡å¤æ ‡é¢˜
âœ… emoji 30+ä¸ª
âœ… çœŸè¯šã€æœ‰å…±é¸£
âœ… æ€»å­—æ•°550-650å­—`;
        
    } else if (templateType === 'æ¨¡æ¿3') {
        // æ¨¡æ¿3ç´ ææŠ½å–ï¼ˆé˜²å¥—è¯ä¸»é¢˜ï¼‰
        const intro = randomPick(MATERIALS.template3['é˜²å¥—è¯'].section1);
        const lead = randomPick(MATERIALS.template3['é˜²å¥—è¯'].section2);
        const methods = MATERIALS.template3['é˜²å¥—è¯'].methods;
        const summary = randomPick(MATERIALS.template3['é˜²å¥—è¯'].section4);
        
        // ä¸ºæ¯ä¸ªæ–¹æ³•éšæœºé€‰æ‹©ä¸€ä¸ªè¡¨è¾¾
        const method1 = randomPick(methods[0].variants);
        const method2 = randomPick(methods[1].variants);
        const method3 = randomPick(methods[2].variants);
        const method4 = randomPick(methods[3].variants);
        const method5 = randomPick(methods[4].variants);
        
        filledPrompt = `ä½ æ˜¯å°çº¢ä¹¦çˆ†æ¬¾æ–‡æ¡ˆä¸“å®¶ã€‚è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ç´ æç”Ÿæˆæ–‡æ¡ˆï¼š

æ ‡é¢˜ï¼š${title}

ã€ç¬¬1æ®µï¼šç—›ç‚¹ 50-60å­—ã€‘
âš ï¸ å¼€å¤´ç»å¯¹ä¸è¦é‡å¤æ ‡é¢˜ï¼
ä½¿ç”¨è¿™æ®µï¼š
"${intro}"
åŠ emojiï¼šğŸ˜£ ğŸ˜«

ã€ç¬¬2æ®µï¼šå¼•å‡ºæ–¹æ³• 30-40å­—ã€‘
ä½¿ç”¨è¿™æ®µï¼š
"${lead}"
åŠ emojiï¼šğŸ’¡ âœ¨

ã€ç¬¬3æ®µï¼š5ä¸ªæ–¹æ³• 200-250å­—ã€‘
1ï¸âƒ£ ${methods[0].title}ï¼š
${method1}

2ï¸âƒ£ ${methods[1].title}ï¼š
${method2}

3ï¸âƒ£ ${methods[2].title}ï¼š
${method3}

4ï¸âƒ£ ${methods[3].title}ï¼š
${method4}

5ï¸âƒ£ ${methods[4].title}ï¼š
${method5}

ã€ç¬¬4æ®µï¼šæ€»ç»“ 60-80å­—ã€‘
ä½¿ç”¨è¿™æ®µï¼š
"${summary}"
åŠ emojiï¼šğŸ“š ğŸ’ª

ã€å›ºå®šç»“å°¾+è¯é¢˜ã€‘åŒæ¨¡æ¿1

ã€è¦æ±‚ã€‘
âœ… ä¸¥æ ¼ä½¿ç”¨æä¾›çš„ç´ æ
âœ… ä¸è¦é‡å¤æ ‡é¢˜
âœ… emoji 35+ä¸ª
âœ… å¹²è´§ã€å¯æ“ä½œ
âœ… æ€»å­—æ•°550-650å­—`;
        
    } else {
        // é»˜è®¤æ¨¡æ¿1
        filledPrompt = `ç”Ÿæˆå°çº¢ä¹¦æ–‡æ¡ˆ...`;
    }
    
    // è°ƒç”¨API
    const response = await fetch(CONFIG.API_BASE_URL, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${apiKey}`
        },
        body: JSON.stringify({
            model: CONFIG.MODEL,
            max_tokens: 900,
            temperature: 0.8,  // é™ä½æ¸©åº¦ï¼Œæ›´ä¸¥æ ¼éµå®ˆç´ æ
            messages: [{
                role: 'user',
                content: filledPrompt
            }]
        })
    });
    
    if (!response.ok) {
        throw new Error(`APIé”™è¯¯: ${response.statusText}`);
    }
    
    const data = await response.json();
    
    let content = '';
    if (data.content && Array.isArray(data.content) && data.content.length > 0) {
        content = data.content[0].text || '';
    } else if (data.text) {
        content = data.text;
    } else if (typeof data === 'string') {
        content = data;
    }
    
    if (!content || content.trim() === '') {
        throw new Error('APIè¿”å›å†…å®¹ä¸ºç©º');
    }

```

---

## ğŸ¯ æ•ˆæœæ¼”ç¤º

### ç¤ºä¾‹1ï¼šæ¥è¯ä¸»é¢˜
```
æ ‡é¢˜: "ä¼šæ¥è¯çš„å¥³å­©å­æœ‰å¤šå‰å®³"
é€‰é¢˜: "æ¥è¯"

ç”Ÿæˆçš„è¯é¢˜æ ‡ç­¾:
#æ¥è¯ #ä¼šæ¥è¯ #æ¥è¯æŠ€å·§ #èŠå¤©è¯æœ¯ #ç¤¾äº¤èƒ½åŠ› #é«˜æƒ…å•† #èŠå¤©é«˜æ‰‹ #æ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—
```

### ç¤ºä¾‹2ï¼šäººæƒ…ä¸–æ•…ä¸»é¢˜
```
æ ‡é¢˜: "ä½ çš„ç­”è°¢æ–¹å¼æš´éœ²ç¤¾äº¤æ®µä½"
é€‰é¢˜: "äººæƒ…ä¸–æ•…"

ç”Ÿæˆçš„è¯é¢˜æ ‡ç­¾:
#ç­”è°¢ #ç¤¾äº¤æ®µä½ #èŒåœºäººæƒ…ä¸–æ•… #äººæƒ…å¾€æ¥ #ä¸ºäººå¤„äº‹ #é«˜æƒ…å•† #ç¤¼ä»ª #æ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—
```

### ç¤ºä¾‹3ï¼šèŒåœºä¸»é¢˜
```
æ ‡é¢˜: "èŒåœºæ–°äººå¿…å­¦çš„æ•¬é…’è¯æœ¯"
é€‰é¢˜: "é¥­å±€"

ç”Ÿæˆçš„è¯é¢˜æ ‡ç­¾:
#èŒåœºæ–°äºº #æ•¬é…’è¯æœ¯ #é¥­å±€ #èŒåœºç¤¾äº¤ #èŒåœºç¤¼ä»ª #åº”é…¬ #ä¸Šç­æ— #æ™®é€šäººç¤¾ä¼šåŒ–æŒ‡å—
if (!content || content.trim() === '') {
        throw new Error('APIè¿”å›å†…å®¹ä¸ºç©º');
    }
    
    // ========== åŠ¨æ€ç”ŸæˆSEOè¯é¢˜æ ‡ç­¾ ==========
    // ç§»é™¤AIç”Ÿæˆçš„å›ºå®šæ ‡ç­¾ï¼ˆå¦‚æœæœ‰ï¼‰
    content = content.replace(/#[^\s#\n]+/g, '').trim();
    
    // ç”ŸæˆåŠ¨æ€SEOæ ‡ç­¾
    const seoTags = generateSEOTags(title, topic, content);
    
    // æ·»åŠ åˆ°æ–‡æ¡ˆæœ«å°¾
    content = content + '\n\n' + seoTags;
    
    return content.trim();
}
        
        function downloadExcel(data) {
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "ç”Ÿæˆç»“æœ");
            
            const timestamp = new Date().toISOString().replace(/[:-]/g, '').split('.')[0];
            XLSX.writeFile(wb, `å°çº¢ä¹¦æ–‡æ¡ˆ_${timestamp}.xlsx`);
        }
        
        // ========== UIè¾…åŠ©å‡½æ•° ==========
        function showStatus(element, message, type) {
            element.textContent = message;
            element.className = `status ${type}`;
            element.style.display = 'block';
        }
        
        function updateProgress(percent) {
            const fill = document.getElementById('progressFill');
            fill.style.width = percent + '%';
            fill.textContent = Math.round(percent) + '%';
        }
        
        function addLog(message) {
            const log = document.getElementById('log');
            const item = document.createElement('div');
            item.className = 'log-item';
            item.textContent = message;
            log.appendChild(item);
            log.scrollTop = log.scrollHeight;
        }
        
        // ========== æ¢å¤ä¸Šæ¬¡ç”Ÿæˆçš„ç»“æœ ==========
        function restoreLastResults() {
            const savedResults = localStorage.getItem('lastGeneratedResults');
            const savedTime = localStorage.getItem('lastGeneratedTime');
            
            if (savedResults) {
                try {
                    const results = JSON.parse(savedResults);
                    
                    const logDiv = document.getElementById('log');
                    logDiv.innerHTML = '';
                    addLog(`ğŸ”„ æ¢å¤äº†ä¸Šæ¬¡ç”Ÿæˆçš„ç»“æœï¼ˆ${savedTime}ï¼‰`);
                    addLog(`ğŸ“Š å…± ${results.length} æ¡æ–‡æ¡ˆ`);
                    
                    const downloadBtn = document.createElement('button');
                    downloadBtn.textContent = 'ğŸ“¥ ä¸‹è½½æ¢å¤çš„ç»“æœ';
                    downloadBtn.style.cssText = `
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        padding: 12px 24px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-size: 16px;
                        margin: 15px 0;
                        font-weight: bold;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                        display: block;
                        width: 100%;
                    `;
                    downloadBtn.onclick = () => {
                        downloadExcel(results);
                        addLog('âœ… æ–‡ä»¶å·²ä¸‹è½½ï¼');
                    };
                    
                    logDiv.appendChild(downloadBtn);
                    document.getElementById('progressContainer').classList.remove('hidden');
                    
                } catch (e) {
                    alert('æ¢å¤å¤±è´¥ï¼šæ•°æ®å·²æŸå');
                }
            } else {
                alert('æ²¡æœ‰æ‰¾åˆ°ä¸Šæ¬¡çš„ç”Ÿæˆç»“æœ');
            }
        }
        
        // ========== é¡µé¢åŠ è½½åˆå§‹åŒ– ==========
        window.onload = function() {
            const activation = localStorage.getItem('activation');
            const apiKey = localStorage.getItem('apiKey');
            
            if (activation) {
                const info = JSON.parse(activation);
                document.getElementById('activationSection').classList.add('hidden');
                document.getElementById('activatedInfo').classList.remove('hidden');
                document.getElementById('apiSection').classList.remove('hidden');
                document.getElementById('businessInfo').textContent = info.business;
                document.getElementById('expireInfo').textContent = info.expireDate;
                
                if (apiKey) {
                    document.getElementById('apiKey').value = apiKey;
                    document.getElementById('generateSection').classList.remove('hidden');
                }
            }
            
            // âœ¨ æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„ç»“æœ
            const savedResults = localStorage.getItem('lastGeneratedResults');
            const savedTime = localStorage.getItem('lastGeneratedTime');
            
            if (savedResults) {
                const restoreBtn = document.getElementById('restoreBtn');
                if (restoreBtn) {
                    restoreBtn.style.display = 'block';
                    restoreBtn.textContent = `ğŸ”„ æ¢å¤ä¸Šæ¬¡ç»“æœï¼ˆ${savedTime}ï¼‰`;
                }
            }
            
            setQuickDate(365);
        };
    </script>
</body>
</html>
